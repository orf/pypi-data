{
    "1.0.0": {
        "info": {
            "author": "\u5f20\u5927\u9e4f",
            "author_email": "lxgzhw@163.com",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: MIT License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9"
            ],
            "description": "# zdpapi_elastic_search\npython\u5feb\u901f\u64cd\u4f5cElasticSearch\u7684\u7ec4\u4ef6\n\n## \u4e00\u3001\u5feb\u901f\u5165\u95e8\u6848\u4f8b\n\u5b89\u88c5\n```shell\npip install zdpapi_elastic_search\n```\n\n\u589e\u5220\u6539\u67e5\u6848\u4f8b\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\n\n# \u8fde\u63a5ES\nes = EsClient()\nprint(es.conn)\n\n# \u67e5\u8be2\nquery = {\n  \"query\": {\n    \"match_all\": {}\n  }\n}\nresult = es.find(index=\"megacorp\", body=query)\nprint(result)\n\n# \u65b0\u589e\n# \u4e0d\u6307\u5b9aid \u81ea\u52a8\u751f\u6210\nes.add(index=\"megacorp\",body={\"first_name\":\"xiao\",\"last_name\":\"xiao\", 'age': 25, 'about': 'I love to go rock climbing', 'interests': ['game', 'play']})\n# \u6307\u5b9aIDwu\nes.add(index=\"megacorp\",id=4,body={\"first_name\":\"xiao\",\"last_name\":\"wu\", 'age': 66, 'about': 'I love to go rock climbing', 'interests': ['sleep', 'eat']})\n\n# \u6839\u636eID\u5220\u9664\nes.delete(index='megacorp', id=4)\n```\n\n## \u4e8c\u3001\u5e38\u7528\u529f\u80fd\n\n### 2.1 \u67e5\u770b\u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u770b\u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u6001\nprint(es.health())\n```\n\n### 2.2 \u67e5\u770b\u96c6\u7fa4\u7684\u57fa\u672c\u4fe1\u606f\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u770b\u96c6\u7fa4\u7684\u57fa\u672c\u4fe1\u606f\nprint(es.info())\n```\n\n### 2.3 \u67e5\u770b\u96c6\u7fa4\u5176\u4ed6\u4fe1\u606f\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u770b\u96c6\u7fa4\u7684\u8be6\u7ec6\u4fe1\u606f\nprint(es.detail())\n\n# \u67e5\u770b\u5f53\u524d\u5ba2\u6237\u7aef\u4fe1\u606f\nprint(es.client_info())\n\n# \u67e5\u770b\u6240\u6709\u7684\u7d22\u5f15\nprint(es.indexs())\n\n# \u67e5\u770b\u96c6\u7fa4\u7684\u66f4\u591a\u4fe1\u606f\nprint(es.stats())\n```\n\n### 2.4 \u67e5\u770b\u96c6\u7fa4\u7684\u4efb\u52a1\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u770b\u96c6\u7fa4\u7684\u4efb\u52a1\nprint(es.tasks_get())\n\n# \u67e5\u770b\u96c6\u7fa4\u7684\u5217\u8868\nprint(es.tasks_list())\n```\n\n## \u4e09\u3001\u589e\u5220\u6539\u67e5\n\n### 3.1 \u589e\u52a0\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u6dfb\u52a0\u7d22\u5f15 \u5df2\u5b58\u5728\u4f1a\u62a5\u9519\n# print(es.add_index(\"persons\"))\n\n#index,doc_type,id\u90fd\u4e00\u81f4\u6642\u6703\u8986\u84cb\n#\u63d2\u5165\u8cc7\u6599\nes.add(index=\"persons\",doc_type=\"mytype\",id=2,body={\"name\":\"\u674e\u56db\",\"age\":20,\"time\":datetime.now()})\nes.add(index=\"persons\", doc_type=\"mytype\", id=4, body={\n       \"name1\": \"\u674e\u56db\", \"name2\": \"\u5f35\u4e09\", \"age\": 20, \"time\": datetime.now()})\nes.add(index=\"persons\", doc_type=\"mytype\", id=5, body={\n       \"name1\": \"\u5f35\u4e09\", \"name2\": \"\u674e\u56db\", \"age\": 20, \"time\": datetime.now()})\nes.add(index=\"persons\", doc_type=\"mytype\", id=1, body={\n       \"name\": \"\u5f35\u4e09\", \"age\": 18, \"time\": datetime.now()})\n\n#\u6c92\u6709\u7d22\u5f15\u5c31\u5efa\u7acb\nes.add(index=\"persons111\", doc_type=\"mytype\",id=3,body={\"name\":\"\u738b\u4e94\",\"age\":20,\"time\":datetime.now()})\n\n# \u67e5\u8be2\u6240\u6709\u7d22\u5f15\nprint(es.find_all_index())\nprint(es.indexs())\n\n# \u67e5\u8be2\u6240\u6709\u6570\u636e\nres = es.find()\nprint(res)\n```\n\n### 3.2 \u6839\u636eID\u67e5\u8be2\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u6839\u636eID\u67e5\u8be2\nres = es.find(index=\"persons\", doc_type=\"mytype\", id=1)\nprint(res)\n```\n\n### 3.3 \u67e5\u8be2\u6240\u6709\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u6240\u6709\u6570\u636e\nres = es.find(index=\"persons\")\nprint(res)\n```\n\n### 3.4 \u66f4\u65b0\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n#\u66f4\u65b0\u4e00\u689d\u8cc7\u6599\uff0c\u9700\u8981\u6307\u5b9aindex,doc_type,id\nprint(es.find(index=\"persons\", id=1))\nes.update(index=\"persons\", doc_type=\"mytype\", id=1, body={\"doc\": {\"age\": 10}})\nprint(es.find(index=\"persons\", id=1))\nprint(\"==================\")\n\n# \u6761\u4ef6\u66f4\u65b0\nquery = {\"script\": {\n    \"source\": \"ctx._source['age']=1\"  # \u6539\u70ba\u5b57\u4e32\u6642\u8981\u52a0\u5f15\u865f,\"ctx._source['age']='\u5f35\u4e09'\"\n},\n    'query': {\n    'range': {\n        'age': {\n            'lt': 30\n        }\n    }\n}\n}\nres = es.update(index=\"persons\", doc_type=\"mytype\", query=query)\nprint(res)\n```\n\n### 3.5 \u5220\u9664\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u6839\u636eID\u5220\u9664\nres = es.delete(index=\"persons\", id='2')\nprint(res)\n\n# \u6839\u636e\u6761\u4ef6\u5220\u9664\nres = es.delete(index=\"persons\", query={'query': {'match': {'any': 'data'}}})\nprint(res)\n\n# \u5220\u9664\u7d22\u5f15\nres = es.delete('persons')\nprint(res)\n```\n\n## \u56db\u3001\u67e5\u8be2\n\n### 4.1 \u67e5\u8be2\u5e74\u9f84\u4e3a20\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u6240\u6709\u6570\u636e\nbody = {\n    \"query\": {\n        \"term\": {\n            \"age\": 20\n        }\n    }\n}\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.2 \u67e5\u8be2\u5e74\u9f84\u4e3a18\u621620\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u5e74\u9f84\u4e3a18\u621620\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"terms\": {\n            \"age\": [\n                18, 20\n            ]\n        }\n    }\n}\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.3 \u67e5\u8be2\u540d\u5b57\u5305\u542b\u201c\u5f35\u201d\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u540d\u5b57\u5305\u542b\u201c\u5f35\u201d\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"match\": {\n            \"name1\": \"\u5f35\"\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.4 \u67e5\u8be2name1\u548cname2\u4e2d\u90fd\u5305\u542b\u201c\u56db\u201d\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2name1\u548cname2\u4e2d\u90fd\u5305\u542b\"\u56db\"\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"multi_match\": {\n            \"query\": \"\u56db\",\n            \"fields\": [\"name1\", \"name2\"]\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.5 \u67e5\u8be2ID\u4e3a1\u62162\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2ID\u4e3a1\u62162\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"ids\": {\n            \"values\": [\n                \"1\", \"2\"\n            ]\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.6 \u67e5\u8be2name1=\u5f20\u4e09\u6216\u8005age=20\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# must(\u90fd\u6eff\u8db3),should(\u5176\u4e2d\u4e00\u500b\u6eff\u8db3),must_not(\u90fd\u4e0d\u6eff\u8db3)\n# \u67e5\u8be2name1=\u5f20\u4e09\u6216\u8005age=20\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"bool\": {\n            \"should\": [\n                {\n                    \"term\": {\n                        \"name\": \"\u5f35\u4e09\"\n                    }\n                },\n                {\n                    \"term\": {\n                        \"age\": 20\n                    }\n                }\n            ]\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.7 \u67e5\u8a6218<=age<=30\u7684\u6240\u6709\u8cc7\u6599\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n'''\nrange\u4e0d\u652f\u63f4:\n    eq \u7b49\u65bc  \n    neq \u4e0d\u7b49\u65bc\n    \nrange\u652f\u63f4:\n    gt: greater than \u5927\u65bc\n    gte: greater than or equal \u5927\u65bc\u7b49\u65bc\n    lt: less than \u5c0f\u65bc\n    lte: less than or equal \u5c0f\u65bc\u7b49\u65bc\n'''\n# \u67e5\u8a6218<=age<=30\u7684\u6240\u6709\u8cc7\u6599\nbody = {\n    \"query\": {\n        \"range\": {\n            \"age\": {\n                \"gte\": 18,       # >=18\n                \"lte\": 30        # <=30\n            }\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.8\u67e5\u8be2\u5e74\u9f84\u6700\u5c0f\u76844\u6761\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u5206\u9875\u67e5\u8be2\nbody = {\n    \"query\": {\n        \"match_all\": {}\n    },\n\n    \"sort\": [{\"age\": {\"order\": \"asc\"}}],  # \u6392\u5e8f,asc\u662f\u6307\u5b9a\u5217\u6309\u5347\u5e8f\u6392\u5217\uff0cdesc\u5247\u662f\u6307\u5b9a\u5217\u6309\u964d\u5e8f\u6392\u5217\n    \"from\": 0,    # \u5f00\u59cb\u7d22\u5f15\n    \"size\": 4    # \u83b7\u53d64\u6761\u6570\u636e\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.9 \u67e5\u8be2name1\u4ee5\"\u5f35\"\u5f00\u5934\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2name1\u4ee5\"\u5f35\"\u5f00\u5934\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"prefix\": {\n            \"name1\": \"\u5f35\"\n        }\n    }\n}\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.10 \u67e5\u8be2name1\u4ee5\"\u4e09\"\u7ed3\u5c3e\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2name1\u4ee5\"\u4e09\"\u7ed3\u5c3e\u7684\u6570\u636e\nbody = {\n    \"query\": {\n        \"wildcard\": {\n            \"name1\": \"*\u4e09\"\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.11 \u67e5\u8be2\u6240\u6709\u6570\u636e\u5e76\u6839\u636e\u5e74\u9f84\u5347\u5e8f\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u6240\u6709\u6570\u636e\u5e76\u6839\u636e\u5e74\u9f84\u5347\u5e8f\nbody = {\n    \"query\": {\n        \"match_all\": {}\n    },\n    \"sort\": {\n        \"age\": {                 # \u6839\u636e\u5e74\u9f84\u5347\u5e8f\n            \"order\": \"asc\"       # asc\u5347\u5e8f\uff0cdesc\u964d\u5e8f\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\n```\n\n### 4.12 \u67e5\u8be2\u6240\u6709\u6570\u636e\u5e76\u6839\u636e\u5e74\u9f84\u5347\u5e8f\u4e14\u53ea\u83b7\u53d6ID\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u6240\u6709\u6570\u636e\u5e76\u6839\u636e\u5e74\u9f84\u5347\u5e8f\u4e14\u53ea\u83b7\u53d6ID\nbody = {\n    \"query\": {\n        \"match_all\": {}\n    },\n    \"sort\": {\n        \"age\": {                 # \u6839\u636e\u5e74\u9f84\u5347\u5e8f\n            \"order\": \"asc\"       # asc\u5347\u5e8f\uff0cdesc\u964d\u5e8f\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body, filter_path=[\"hits.hits._id\"])\nprint(res)\n```\n\n### 4.13 \u67e5\u8be2\u6570\u636e\u603b\u6570\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n# \u67e5\u8be2\u6570\u636e\u603b\u6570\nres = es.find_count()\nprint(res)\n\nres = es.find_count(index=\"persons\")\nprint(res)\n```\n\n### 4.14 \u67e5\u8be2\u5e74\u9f84\u6700\u5c0f\u7684\u6570\u636e\n```python\n# \u4f7f\u7528python\u64cd\u4f5cElasticSearch\nfrom zdpapi_elastic_search import EsClient\nfrom datetime import datetime\n\n# \u8fde\u63a5ES\nes = EsClient()\n\n'''\nmin:\u6700\u5c0f\nmax:\u6700\u5927\nsum:\u6c42\u548c\navg:\u5e73\u5747\u503c\n'''\n# \u6700\u5c0f\u503c\nbody = {\n    \"query\": {\n        \"match_all\": {}\n    },\n    \"aggs\": {                        # \u805a\u5408\u67e5\u8a62\n        \"min_age\": {                 # \u6700\u5c0f\u503c\u7684key\n            \"min\": {                 # \u6700\u5c0f\n                \"field\": \"age\"       # \u67e5\u8a62\"age\"\u7684\u6700\u5c0f\u503c\n            }\n        }\n    }\n}\n\nres = es.find(index=\"persons\", body=body)\nprint(res)\nprint(res['aggregations'])\n```\n",
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "https://github.com/zhangdapeng520/zdpapi_elastic_search",
            "keywords": "zapi,ElasticSearch,search,zhangdapeng",
            "license": "MIT",
            "maintainer": "",
            "maintainer_email": "",
            "name": "zdpapi-elastic-search",
            "package_url": "https://pypi.org/project/zdpapi-elastic-search/",
            "platform": "",
            "project_url": "https://pypi.org/project/zdpapi-elastic-search/",
            "project_urls": {
                "Documentation": "https://github.com/zhangdapeng520/zdpapi_elastic_search",
                "Homepage": "https://github.com/zhangdapeng520/zdpapi_elastic_search",
                "Repository": "https://github.com/zhangdapeng520/zdpapi_elastic_search"
            },
            "release_url": "https://pypi.org/project/zdpapi-elastic-search/1.0.0/",
            "requires_dist": [
                "elasticsearch (>=7.15.2,<8.0.0)"
            ],
            "requires_python": ">=3.8,<4.0",
            "summary": "python\u64cd\u4f5cElasticSearch\u7684\u57fa\u7840\u7ec4\u4ef6",
            "version": "1.0.0",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 12197950,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "332c9c2253c1b3d4de69649846ff3d59",
                    "sha256": "be4c6c7c35bdab4c4dff0539312bd48af9339389b821635955eee76e2be2414b"
                },
                "downloads": -1,
                "filename": "zdpapi_elastic_search-1.0.0-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "332c9c2253c1b3d4de69649846ff3d59",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.8,<4.0",
                "size": 5786,
                "upload_time": "2021-12-03T05:46:37",
                "upload_time_iso_8601": "2021-12-03T05:46:37.806708Z",
                "url": "https://files.pythonhosted.org/packages/f0/91/6b0e979800f384a96a8ac56993206609dd99d5b146e8e215123f2289c7eb/zdpapi_elastic_search-1.0.0-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "c5b9e8f102e958fce9f830c0ceebd888",
                    "sha256": "0ca919e7c5e7e15fb686dc846c10351b8a6176659fc935d880f0067330923d8f"
                },
                "downloads": -1,
                "filename": "zdpapi_elastic_search-1.0.0.tar.gz",
                "has_sig": false,
                "md5_digest": "c5b9e8f102e958fce9f830c0ceebd888",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.8,<4.0",
                "size": 7365,
                "upload_time": "2021-12-03T05:46:39",
                "upload_time_iso_8601": "2021-12-03T05:46:39.584921Z",
                "url": "https://files.pythonhosted.org/packages/30/0b/c58d7a01bf20ee5dd76dd2e0aaa1e74f30c17217e257a4e3d00405c81ba5/zdpapi_elastic_search-1.0.0.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}