{
    "0.2": {
        "info": {
            "author": "Yuming.Xiao",
            "author_email": "514058722@qq.com",
            "bugtrack_url": null,
            "classifiers": [],
            "description": "# chipmunks\n![Chipmunks Logo](/chipmunks-tail.png)\n\nChipmunks\uff08\u4ee5\u4e0b\u7b80\u79f0munks\uff09\u662f\u7528python\u5f00\u53d1\u7684\u57fa\u4e8enginx\u7684\u8f7b\u91cf\u7ea7\u5fae\u670d\u52a1\u7f51\u5173\u3002\n\nmunks\u53ef\u4ee5\u4e3a\u4f60\u76d1\u63a7\u96c6\u7fa4\u4e2d\u6240\u6709docker\u8282\u70b9\u4e2d\u670d\u52a1\uff0c\u5e76\u751f\u6210nginx\u914d\u7f6e\u6587\u4ef6\uff0c\u5c06\u5230\u6307\u5b9a\u670d\u52a1\u7684\u8bbf\u95ee\u8bf7\u6c42\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684docker\u8282\u70b9\u6307\u5b9a\u7aef\u53e3\u4e0a\u3002\n\n## Why\n\nmunks\u662f\u4f11\u95f2\u65f6\u5019\u4e3a\u4e86\u4e0d\u8ba9\u81ea\u5df1\u624b\u751f\u7684\u7ec3\u4e60\u4e4b\u4f5c\u3002\u5728\u4f7f\u7528python\u5f00\u53d1\u65f6\uff0c\u63a8\u884c\u5fae\u670d\u52a1\u67b6\u6784\u5176\u5b9e\u662f\u4e0d\u592a\u5bb9\u6613\u7684\u3002python\u6ca1\u6709java\u8fd9\u6837\u5b8c\u6574\u7684\u5fae\u670d\u52a1\u751f\u6001\uff0c\u975e\u5e38\u611f\u8c22\u5f53\u65f6\u6709[nameko](http://github.com/nameko)\uff0c\u89e3\u51b3\u4e86\u57fa\u672c\u7684\u670d\u52a1\u6ce8\u518c\u53d1\u73b0\u548cRPC\u673a\u5236\uff08nameko\u7684\u5b9e\u73b0\u4e5f\u76f8\u5f53\u7cbe\u5f69\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u770b\u770b\uff09\u3002nameko\u4e5f\u6709\u81ea\u5df1\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u670d\u52a1\u7ec8\u7aef\u4e86\u65e0\u6cd5\u53ca\u65f6\u53d1\u73b0\uff0c\u5bfc\u81f4RPC\u4e00\u76f4\u7b49\u5f85\u3002\n\n\u60f3\u4e3apython\u5199\u4e00\u4e2a\u5fae\u670d\u52a1\u7f51\u5173\u7684\u60f3\u6cd5\u7531\u6765\u5df2\u4e45\uff0c\u6211\u662f\u4e00\u4e2a\u4f1a\u8ba9\u5de5\u4f5c\u586b\u6ee1\u6240\u6709\u65f6\u95f4\u7684\u4eba\uff0c\u6240\u4ee5\u4e5f\u6ca1\u6709\u592a\u591a\u7684\u7a7a\u95f2\u65f6\u95f4\u6765\u505a\uff0c\u8d81\u77402020\u56fd\u5e86\u957f\u5047\uff0c\u5c06\u8fd9\u4e2a\u60f3\u6cd5\u843d\u5730\u4e86\u3002\n\n## What\n\nmunks\u7684\u6574\u4e2a\u7ed3\u6784\u975e\u5e38\u7b80\u5355\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a\n\n![Munks archtech](/archtech.drawio.png)\n\nmunks\u7531\u7eff\u8272\u7684agent\u548c\u9ec4\u8272\u7684monitor\u7ec4\u6210\u3002\n\nagent\u7528\u4e8e\u548c\u96c6\u7fa4\uff08\u65e0\u8bba\u662fk8s or swarm\u6216\u5176\u4ed6\u5f62\u5f0f\u7684\u96c6\u7fa4\uff09\u4e2d\u7684docker\u8282\u70b9\u4ea4\u4e92\uff0c\u76d1\u63a7docker\u4e2dcontainer\u7684\u751f\u547d\u5468\u671f\uff0c\u5e76\u5c06\u4fe1\u606f\u4fdd\u5b58\u5230\u6307\u5b9a\u7684etcd\u96c6\u7fa4\u4e2d\u3002\n\nmonitor\u5229\u7528\u4e86etcd3\u652f\u6301watch prefix\u7684\u7279\u6027\uff0c\u76d1\u542c\u4e86/chipmunks\u8fd9\u4e2akey prefix\uff0c\u5e76\u89e3\u6790\u5177\u4f53\u7684key\u5185\u5bb9\u751f\u6210\u4e86nginx\u6240\u9700\u8981\u7684location\u7684\u914d\u7f6e\u6587\u4ef6\u3002\n\n\u4f60\u53ea\u9700\u8981\u5728nginx\u7684\u914d\u7f6e\u6587\u4ef6\u4e2dinclude\u5bf9\u5e94\u7684\u6587\u4ef6\u5373\u53ef\u3002\n\n## How\n\n### 0. Requirements\n\n* Docker (in K8S or Swarm)\n* etcd3\n* Python3.2+\n\n### 1. Install munks agent\n\n\u5f53\u524d\u8fd9\u4e2a\u9636\u6bb5Munks\u5e76\u4e0d\u6253\u7b97\u4e0a\u5230pipy\u4ed3\u5e93\u4e2d\uff0c\u4e3b\u8981\u57fa\u4e8e\u4e3a\u5927\u5bb6\u8d1f\u8d23\u7684\u51fa\u53d1\u70b9\u3002\u8be5\u9879\u76ee\u5e76\u6ca1\u6709\u5728\u751f\u4ea7\u73af\u5883\u6709\u5e94\u7528\uff0c\u6211\u5c3d\u91cf\u8ba9\u6211\u7684\u8003\u8651\u66f4\u52a0\u5468\u5168\uff0c\u4f46\u662f\u672a\u7ecf\u9a8c\u8bc1\u5c31\u4e0a\u5230\u4ed3\u5e93\u7684\u786e\u662f\u592a\u8349\u7387\u4e86\u3002\n\n\u6240\u4ee5\u6ce8\u5b9a\u4e86\u8fd9\u4e2a\u6559\u7a0b\u4e0d\u4f1a\u7ed9\u51fa\u975e\u5e38\u5177\u4f53\u7684\u6307\u4ee4\uff0c\u5728\u4f7f\u7528\u8fd9\u4e2a\u5de5\u5177\u7684\u65f6\u5019\u4f60\u9700\u8981\u660e\u786e\u77e5\u9053\u4f60\u5728\u505a\u4ec0\u4e48\u3002\n\n\u5982\u679c\u4f60\u6709\u81ea\u5df1\u7684\u79c1\u670d\uff0c\u76f8\u4fe1\u4e5f\u5e94\u8be5\u77e5\u9053\u5982\u4f55\u52a0\u5165\u8fdb\u53bb\uff0c\u5982\u679c\u4f60\u8fd8\u6ca1\u6709\uff0c\u4f46\u662f\u6bd4\u8f83\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u8bd5\u8bd5nexus\u3002\n\n\u9996\u5148\u4f60\u9700\u8981clone\u672c\u9879\u76ee\u5230docker\u8282\u70b9\u4e0a\uff0c\u7136\u540e\u901a\u8fc7pip\u8fdb\u884c\u5b89\u88c5\u5373\u53ef\u3002\n\n#### Install Munks Service\n\n\u5982\u679c\u4f60\u4f7f\u7528systemd\uff0c\u90a3\u4e48\u4e0b\u9762\u7684service\u6587\u4ef6\u53ef\u4ee5\u5e2e\u4f60\u5feb\u901f\u7684\u5efa\u7acb\u8d77\u542f\u52a8\u811a\u672c\n\n##### Agent Service\n```\n[Unit]\nDescription=chipmunks service\nAfter=docker.target\n\n[Service]\nType=simple\n\n## replace with munks install location\n## chip-agents configure file\u3002\nExecStart=/usr/local/bin/munks agent -c /etc/chips-agent.conf\nRestart=on-abort\nTimeoutSec=600\n\n[Install]\nWantedBy=multi-user.target\n```\n\n\u4f7f\u7528systemd\u76f8\u5173\u547d\u4ee4enable\u5e76\u4e14start\u3002\n\n#### Munks agent \u7684\u914d\u7f6e\u6587\u4ef6\u5b9e\u4f8b\n\n\u6700\u7b80\u5316\u914d\u7f6emunks\u53ef\u4ee5\u53ea\u914d\u7f6eetc3\u5373\u53ef\u3002\u5982\u679c\u9700\u8981\u66f4\u8be6\u7ec6\u7684\u4e2a\u6027\u5316\u914d\u7f6e\uff0c\u53ef\u4ee5\u53c2\u8003cli.py\n```\n[etcd3]\nport = 2379\nhost = 192.168.77.100\n```\n\n\n### 2. Install Munks monitor\n\n\u5728\u4f60\u7684nginx\u524d\u7aef\u673a\u4e0a\uff0c\u540c\u6837\u5b89\u88c5munks\u3002\u65b9\u6cd5\u4e5f\u5c31\u4e0d\u5728\u8be6\u7ec6\u7ed9\u51fa\u3002\n\n\u540c\u6837\u5982\u679c\u4f60\u4f7f\u7528systemd\uff0c\u90a3\u4e48\u4e0b\u9762\u7684service\u6587\u4ef6\u53ef\u4ee5\u5e2e\u51fa\u4f60\u5efa\u7acb\u542f\u52a8\u811a\u672c\n\n##### Monitor Service\n```\n[Unit]\nDescription=chipmunks service\nAfter=docker.target\n\n[Service]\nType=simple\n\n## replace with munks install location\n## chip-agents configure file\u3002\nExecStart=/usr/local/bin/munks chips -c /etc/chips.conf\nRestart=on-abort\nTimeoutSec=600\n\n[Install]\nWantedBy=multi-user.target\n```\n\n#### \u914d\u7f6emonitor\n\n\u6700\u7b80\u5316\u914d\u7f6emonitor\u4f60\u914d\u7f6eetcd\u548cnginx\u76f8\u5173\u914d\u7f6e\uff0c\u5982\u4e0b\n\n```\n[etcd3]\nhost=192.168.77.100\n\n[nginx]\nconfig_path=devops/chipmunks/vagrant-env.d\npid_path=/usr/local/var/run/nginx.pid \n```\n\n\u5176\u4e2dconfig_path\u4e3anginx\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u8be5\u4e86\u8def\u5f84\u9700\u8981\u914d\u7f6e\u5230nginx\u4e2d\uff0c\u540c\u65f6\u9700\u8981nginx pid\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u6211\u4eec\u9700\u8981\u8bfb\u53d6pid\u6587\u4ef6\u5e76\u53d1\u6d88\u606f\u7ed9nginx process\u8ba9nginxreload\u914d\u7f6e\u6587\u4ef6\u3002\n\n\n### 3. \u914d\u7f6enginx\nmunks\u5c06\u5728config_path\u4e2d\u751f\u6210\u4e24\u7c7b\u6587\u4ef6\uff1alocation.conf\u548cupstream.conf\u3002\n\u9700\u8981\u5728nginx\u4e2d\u914d\u7f6einclude\u76f8\u5e94\u7684\u6587\u4ef6\u5373\u53ef\u3002\n\n\u5728http\u6bb5include *.upstream.conf\u3002\n\n\u5728server\u6bb5include *.location.conf\u3002\n\n\u5982\u679c\u4f60\u4e0d\u6e05\u695a\u4e0a\u9762\u7684\u5728\u8bf4\u4ec0\u4e48\uff0c\u8bf4\u660e\u4f60\u5bf9nginx\u4e5f\u4e0d\u592a\u719f\u6089\uff0c\u53ef\u4ee5\u5148\u4e86\u89e3\u4e00\u4e0bnginx\u7684\u914d\u7f6e\u5148\u3002\n\n## vagrant\n\n\u5982\u679c\u4f60\u4ec5\u4ec5\u60f3\u8bd5\u8bd5munks\uff0c\u5e76\u4e14\u6bd4\u8f83\u4e86\u89e3vagrant\uff0c\u6211\u4e5f\u63d0\u4f9b\u4e86vagrant\u7684\u811a\u672c\uff0c\u5e2e\u4f60\u5feb\u901f\u7684\u5efa\u7acb\u8d77docker swarm\u6a21\u5f0f\u7684\u96c6\u7fa4\u5e76\u4e14\u5b89\u88c5\u597dmunks\u3002\n\n\u76f8\u5173\u7684\u6587\u4ef6\u53ef\u4ee5\u53c2\u8003vagrant\u76ee\u5f55\u3002\n\n## About Logo\n\nLogo\u662f\u4e00\u53ea\u677e\u9f20\u5c3e\u5df4\uff0c\u7279\u522b\u5f3a\u8c03\u4e00\u4e0b\u662f\u56e0\u4e3aLogo\u662f\u6211\u81ea\u5df1\u753b\u7684\uff0c\u62c5\u5fc3\u5927\u5bb6\u8ba4\u4e0d\u51fa\u6765\u3002\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u662f\u677e\u9f20\u5c3e\u5df4\uff0c\u90a3\u662f\u5728\u56fd\u5e86\u65c5\u9014\u4e2d\uff0c\u5ef6\u5ddd\u5230\u58f6\u53e3\u6bb5\uff0c\u672c\u6765\u6709\u70b9\u8ff7\u7cca\u957f\u65f6\u95f4\u8f66\u7a0b\uff0c\u7a81\u7136\u8dc3\u51fa\u5230\u516c\u8def\u4e0a\u7684\u4e00\u53ea\u5c0f\u677e\u9f20\uff0c\u70b9\u4eae\u4e86\u540e\u7eed\u65c5\u7a0b\uff0c\u5c0f\u5b69\u5b50\u4e5f\u5174\u594b\u8d77\u6765\uff0c\u5927\u4eba\u4e5f\u5f00\u59cb\u6d3b\u8dc3\u8d77\u6765\u3002\n\n\u56de\u5bb6\u540e\u4ecd\u7136\u8bb0\u5f97\u90a3\u53ea\u677e\u9f20\uff0c\u5e72\u8106\u5728\u4f5c\u4e3amunks\u7684Logo\u5427\u3002\n\n\n",
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "http://git.lingmao.tech/xiaoym/chipmunks",
            "keywords": "",
            "license": "",
            "maintainer": "",
            "maintainer_email": "",
            "name": "chipmunks",
            "package_url": "https://pypi.org/project/chipmunks/",
            "platform": "",
            "project_url": "https://pypi.org/project/chipmunks/",
            "project_urls": {
                "Homepage": "http://git.lingmao.tech/xiaoym/chipmunks"
            },
            "release_url": "https://pypi.org/project/chipmunks/0.2/",
            "requires_dist": [
                "Jinja2 (>=2.11.2)",
                "etcd3 (>=0.12.0)",
                "docker (>=4.3.1)"
            ],
            "requires_python": ">= 3.5",
            "summary": "Chipmunks is lightweight api gateway based on nginx.",
            "version": "0.2",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 9162024,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "cee4c8fcba58b032b56a289426be8c43",
                    "sha256": "2dd07adf26c0744bb3c3505e72c90892aebc388f70ed63a26de43741f1dfa33a"
                },
                "downloads": -1,
                "filename": "chipmunks-0.2-py2.py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "cee4c8fcba58b032b56a289426be8c43",
                "packagetype": "bdist_wheel",
                "python_version": "py2.py3",
                "requires_python": ">= 3.5",
                "size": 19115,
                "upload_time": "2021-01-18T10:03:23",
                "upload_time_iso_8601": "2021-01-18T10:03:23.253825Z",
                "url": "https://files.pythonhosted.org/packages/11/1a/7997fb27aa68dfb144b0aa440ee680a9155dafe38d926f4a1ee7c3b4a1b8/chipmunks-0.2-py2.py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}