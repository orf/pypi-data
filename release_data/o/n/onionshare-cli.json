{
    "2.3": {
        "info": {
            "author": "Micah Lee",
            "author_email": "micah@micahflee.com",
            "bugtrack_url": null,
            "classifiers": [
                "Environment :: Web Environment",
                "Framework :: Flask",
                "Intended Audience :: End Users/Desktop",
                "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
                "License :: Other/Proprietary License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.6",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9",
                "Topic :: Communications :: File Sharing",
                "Topic :: Security :: Cryptography"
            ],
            "description_content_type": "",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "GPLv3+",
            "maintainer": "",
            "maintainer_email": "",
            "name": "onionshare-cli",
            "package_url": "https://pypi.org/project/onionshare-cli/",
            "platform": "",
            "project_url": "https://pypi.org/project/onionshare-cli/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/onionshare-cli/2.3/",
            "requires_dist": [
                "click",
                "flask",
                "flask-httpauth",
                "flask-socketio",
                "psutil",
                "pycryptodome",
                "pysocks",
                "requests",
                "stem",
                "unidecode",
                "urllib3",
                "eventlet",
                "setuptools"
            ],
            "requires_python": ">=3.6,<4.0",
            "summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
            "version": "2.3",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15355783,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "2a234a310f8f70e326c566a45c2a67f9",
                    "sha256": "73da2ea7d9fecfa245d95392ef10c8ab9ea61c0f0027f3a83108ab0e3ab2c18c"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "2a234a310f8f70e326c566a45c2a67f9",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.6,<4.0",
                "size": 154266,
                "upload_time": "2021-02-22T01:14:33",
                "upload_time_iso_8601": "2021-02-22T01:14:33.316382Z",
                "url": "https://files.pythonhosted.org/packages/f2/af/a2ef33f4a0db9510c1cebe370f4f3ea5bf1a3f2ca02daace7e5cf8a12c58/onionshare_cli-2.3-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "cc51e9f0267ab3318d252c43210f9eca",
                    "sha256": "53a9101dba56e0d6f346707f0d3b6bea65335aacbc0590732b4f264c76803726"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.tar.gz",
                "has_sig": false,
                "md5_digest": "cc51e9f0267ab3318d252c43210f9eca",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.6,<4.0",
                "size": 137953,
                "upload_time": "2021-02-22T01:14:34",
                "upload_time_iso_8601": "2021-02-22T01:14:34.884557Z",
                "url": "https://files.pythonhosted.org/packages/ea/b6/d9cfb683e6e0d1e283905a306efafd4a797e12c61975625f7b6fcb3628de/onionshare_cli-2.3.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [
                    "CVE-2022-21694",
                    "GHSA-h29c-wcm8-883h"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. The website mode of the onionshare allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-45",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-45",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689",
                    "GHSA-jh82-c5jw-pxpc"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions the receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script. An adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-40",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-40",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695",
                    "GHSA-99p8-9p2c-49j4"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions authenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants. This issue has been resolved in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-46",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-46",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690",
                    "GHSA-ch22-x2v3-v6vq"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions The path parameter of the requested URL is not sanitized before being passed to the QT frontend. This path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-41",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-41",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691",
                    "GHSA-w9m4-7w72-r766"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-42",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-42",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688",
                    "GHSA-x7wr-283h-5h2v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. Affected versions of the desktop application were found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. An adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated. This issue has been patched in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-39",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-39",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693",
                    "GHSA-jgm9-xpfj-4fq6"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions an adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced. This can be mitigated by usage of the flatpak release.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-44",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-44",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692",
                    "GHSA-gjj5-998g-v36v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions anyone with access to the chat environment can write messages disguised as another chat participant.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-43",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-43",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696",
                    "GHSA-68vr-8f46-vc9f"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions it is possible to change the username to that of another chat participant with an additional space character at the end of the name string. An adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-47",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-47",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-003\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nAnyone with access to the chat environment can write messages disguised as another chat participant.\n\n## Technical description:\n\nPrerequisites:\n\n- Alice and Bob are legitimate users\n- A third user has access to the chat environment\n\n![otf-003-a](https://user-images.githubusercontent.com/156128/140665707-1ecc897e-d33b-4f5b-b585-eb4475c1599f.png)\n\nThis screenshot shows Alice (`glimpse-depress`) and Bob (`blinker-doorpost`) joined a chatroom and are the only participants in the chatroom. Then the non-listed user squad-nursing writes a message in the chatroom without being visible in the list of users. The sending of the message itself is not required but was done here to show the initial access. The non-listed participant now renames himself to Bob and writes another message, seemingly coming from Bob.\n\nThis can be reproduced by slightly modifying the client-side JavaScript. The `joined` emit needs to be removed from the `socket.on(connect) `event handler. Therefore a client is not listed in the userlist and has no active session.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/resources/static/js/chat.js#L16-L18\n\nThis can be done either via a crafted client or runtime modification of the `chat.js` script in the browser's internal debugger.\n\nIt is still possible to call the text method and send text to the chat via websocket.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L131-L139\n\nIt is also possible to call the `update_username` function and choose an existing username from the chat.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L141-L162\n\nAfterwards the hidden user can send messages that are displayed as coming from the impersonated user. There is no way to distinguish between the fake and original message.\n\n## Impact:\n\nAn adversary with access to the chat environment can impersonate existing chat participants and write messages but not read the conversation. The similar exploit described in OTF-004 (page 19) has only slightly more requirements but also allows for reading.\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-gjj5-998g-v36v",
                "link": "https://osv.dev/vulnerability/GHSA-gjj5-998g-v36v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41868"
                ],
                "details": "OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to upload files on a non-public node when using the --receive functionality. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-7g47-xxff-9p85",
                "link": "https://osv.dev/vulnerability/GHSA-7g47-xxff-9p85",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-004\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nChat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.\n\n## Technical description:\n\n![otf-004-a](https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png)\n![otf-004-b](https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png)\n![otf-004-c](https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png)\n\nThis series of screenshots show Alice, Bob and Eve joined a chatroom and are the only participants in the chatroom. Eve seemingly leaves the chatroom, which leads Bob and Alice to believe they are having a private chat. The last screenshot shows that Eve only emitted the leave message and is still able to read the chat and possibly write messages.\n\nThis can be reproduced by joining the chat with two different instances, where one instance has slightly modified the client-side JavaScript code similar to OTF-003 (page 22). The joined emit needs to be removed from the connect event handler. Therefore the modified client is not listed in the userlist and has no active session. The modified non-listed user also needs to change their username to Eve, which is not shown in the chatroom. The modified client then emits the disconnect event and their connection is no longer usable.\n\nThis results in the leave message for Eve and the removal from the user-list but not in removal of the original session of the Eve who announced to join the chat.\n\n## Impact:\n\nAn adversary with access to the chat environment can spoof his leave event but still persist in the chat with access to all sent messages and the possibility to write in the chat using OTF-003 (page 22).\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-w9m4-7w72-r766",
                "link": "https://osv.dev/vulnerability/GHSA-w9m4-7w72-r766",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41867"
                ],
                "details": "An information disclosure vulnerability in OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to retrieve the full list of participants of a non-public OnionShare node via the --chat feature. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-6rvj-pw9w-jcvc",
                "link": "https://osv.dev/vulnerability/GHSA-6rvj-pw9w-jcvc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-009\n- Vulnerability type: Improper Access Control\n- Threat level: Low\n\n## Description:\n\nAuthenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants.\n\n## Technical description:\n\nPrerequisites:\n\n- Existing chatroom\n- Access to the chatroom (Public or known Private Key)\n- Either a modified frontend client or manual requests from burp/curl\n\nIf a user opens the chatroom without emitting the join message he will not be present in session.users[x] list. Therefore there is no listing in the frontend and no chat participant knows another party joined the chat. It is still possible to send messages in the chatroom.\n\nIf a user decides to abuse OTF-003 (page 22) he can impersonate messages from existing users; others would not be able to distinguish original and faked messages. This is also a prerequisite for OTF-004 (page 19).\n\n## Impact:\n\nAn adversary with access to the chat environment can send messages to the chat without being visible in the list of chat participants.\n\n## Recommendation:\n\n- Allow chat access only after emission of the join event.\n- Implement proper session handling.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-99p8-9p2c-49j4",
                "link": "https://osv.dev/vulnerability/GHSA-99p8-9p2c-49j4",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-001\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Elevated\n\n## Description:\n\nThe `path` parameter of the requested URL is not sanitized before being passed to the QT frontend.\n\n## Technical description:\n\nThe `path` parameter is not sanitized before being passed to the constructor of the `QLabel`.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/__init__.py#L499-L509\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/history.py#L456-L483\n\nhttps://doc.qt.io/qt-5/qlabel.html#details\n\n> Warning: When passing a QString to the constructor or calling setText(), make sure to sanitize your input, as QLabel tries to guess whether it displays the text as plain text or as rich text, a subset of HTML 4 markup. You may want to call setTextFormat() explicitly, e.g. in case you expect the text to be in plain format but cannot control the text source (for instance when displaying data loaded from the Web).\n\nThis path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.\n\nIn the following example an adversary injects a crafted image file into an Onionshare instance with receive mode and renders it in the history component of the Onionshare application.\n\nThe only requirement is another visit to the shared site with the following parameter attached to the path of the URL:\n\n```\n<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVQY02Nk+M+ABzAxMIxKYwIAQC0BEwZFOw4AAAAASUVORK5CYII=' />\n```\n\nThis will be rendered as a green square in the history tab where the path value is supposed to be (the value itself is shown at the bottom of the page).\n\n![otf-001](https://user-images.githubusercontent.com/156128/140665358-ab9e5990-3e13-4e50-85fd-b8a6e323d299.png)\n\nPossible scenarios where this could lead to remote code execution would be a 0-day in libpng or other internal image rendering (OTF-014 (page 12)) of the QT framework.\n\nThe QT documentation indicates that external files could be rendered, but we were unable to find a QT code path allowing for it.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can render arbitrary HTML (QT-HTML4 Subset) in the server desktop application. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Manually define the text format of the QLabel via `setTextFormat()`",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-ch22-x2v3-v6vq",
                "link": "https://osv.dev/vulnerability/GHSA-ch22-x2v3-v6vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-013\n- Vulnerability type: Improper Hardening\n- Threat level: Low\n\n## Description:\n\nThe filesystem restriction could be hardened and should only allow for pre-defined subfolders.\n\n## Technical description:\n\nThe Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are `onionshare/snap/snapcraft.yaml#L20` and `onionshare/flatpak/org.onionshare.OnionShare.yaml#L19` , respectively.\n\nThe encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.\n\nSadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.\n\n## Impact:\n\nAn adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.\n\n## Recommendation:\n\n- Reduce read access in Flatpak configuration.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jgm9-xpfj-4fq6",
                "link": "https://osv.dev/vulnerability/GHSA-jgm9-xpfj-4fq6",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/).\n\n- Vulnerability ID: OTF-012\n- Vulnerability type: Denial of Service\n- Threat level: Moderate\n\n## Description:\n\nThe receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script.\n\n## Technical description:\n\nThe following script uses GNU parallel and curl with around 6000 requests in parallel to send 10000 requests. A change in the `ulimit -n` configuration is required for it to work. This is sufficient to block file upload on a (public) receive instance.\n\n```\nseq 10000 | parallel --max-args 0 --jobs 6000 \"curl -i -s -x socks5h://localhost:9150 -k -X $'POST' -H $'Host: csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: multipart/form-data; boundary=---------------------------19182376703918074873375387042' -H $'Content-Length: 329' -H $'Connection: close' --data-binary $'-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"file[]\\\"; filename=\\\"poc.txt\\\"\\x0d\\x0aContent-Type: text/plain\\x0d\\x0a\\x0d\\x0aA\\x0d\\x0a-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"text\\\"\\x0d\\x0a\\x0d\\x0a\\x0d\\x0a-----------------------------19182376703918074873375387042--\\x0d\\x0a' $'http://csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion/upload-ajax'\"\n```\n\nAttack duration was around 80 seconds.\n\nCases where over 99 requests were sent per second:\n\n```\nEvery 0.1s: ls | grep...   onionvm: Tue Oct 5 12:17:00 2021\n78\n```\n\nCases where files were successfully written to disk:\n\n```\nEvery 0.1s: ls | wc -w   onionvm: Tue Oct 5 12:17:00 2021\n8399\n```\n\nThis means that during the attack time 1601 requests of 10000 were dropped. We tried to upload multiple files in the web interface during the attack and were not successful.\n\nThe failsafe is used to prevent creating more than 100 directories per second:\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/receive_mode.py#L386-L427\n\nThe limit of 100 requests/second is significantly lower than the possible network bandwidth and greatly reduces the attack complexity for denial of service. Our test was conducted over the tor network, which showed no limitation for the required bandwidth.\n\n## Impact:\n\nAn adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.\n\n## Recommendation:\n\n- Remove this limitation, or\n- Derive directory name from milliseconds\n",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jh82-c5jw-pxpc",
                "link": "https://osv.dev/vulnerability/GHSA-jh82-c5jw-pxpc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-014\n- Vulnerability type: Out-of-bounds Read\n- Threat level: Elevated\n\n## Description:\n\nThe desktop application was found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing.\n\n## Technical description:\n\nPrerequisites:\n\n- Onion address is known\n- Public service or authentication is valid\n- Desktop application is used\n- History is displayed\n\nThe rendering of images found in OTF-001 (page 25) could be elevated to a Denial of Service, which requires only very few bytes to be sent as a path parameter to any of the Onionshare functions. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. The issue is in the process of disclosure to the QT security mailing list. More details will be provided after a fixed QT build has been deployed.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Monitor for upstream fix\n- Fix OTF-001 (page 25) as a workaround",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-x7wr-283h-5h2v",
                "link": "https://osv.dev/vulnerability/GHSA-x7wr-283h-5h2v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-005\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Low\n\n## Description:\n\nIt is possible to change the username to that of another chat participant with an additional space character at the end of the name string.\n\n## Technical description:\n\nAssumed users in Chat:\n\n- Alice\n- Bob\n- Mallory\n\n1. Mallory renames to `Alice `.\n2. Mallory sends message as `Alice `.\n3. Alice and Bob receive a message from Mallory disguised as `Alice `, which is hard to distinguish from the `Alice`\nin the web interface.\n\n![otf-005-a](https://user-images.githubusercontent.com/156128/140666112-8febd4d8-6761-41aa-955c-48be76f3c657.png)\n![otf-005-b](https://user-images.githubusercontent.com/156128/140666113-1713ddf7-cef6-4dac-b718-9af1dc4ffdcd.png)\n\nOther (invisible) whitespace characters were found to be working as well.\n\n## Impact:\n\nAn adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.\n\n## Recommendation:\n\n- Remove non-visible characters from the username",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-68vr-8f46-vc9f",
                "link": "https://osv.dev/vulnerability/GHSA-68vr-8f46-vc9f",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21694"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-006\n- Vulnerability type: Broken Website Hardening Control\n- Threat level: Low\n\n## Description:\n\nThe CSP can be turned on or off but not configured for the specific needs of the website.\n\n## Technical description:\n\nThe website mode of the application allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.\n\nIf CSP were configurable, the website creator could harden it accordingly to the needs of the application.\n\nAs this issue correlates with the Github issue for exposing the flask application directly (https://github.com/onionshare/ onionshare/issues/1389), it can be assumed that this can be solved by either changing to a well-known webserver, which supports this kind of configuration, or enhancing the status quo by making the CSP a configurable part of each website.\n\nWe believe that bundling the nginx or apache webserver would add complexity and dependencies to the application that could result in a larger attack surface - as these packages receive regular security updates. On the other hand it is not recommended to directly expose the flask webserver, due to lack of hardening. This is a trade-off which needs to be evaluated by the Onionshare developers, as multiple features are involved. Ideally the application user could choose between the built-in flask webserver or a system webserver of choice.\n\n## Impact:\n\nAs this is a general weakness and not a direct vulnerability in the Onionshare application, the direct impact of this issue is rather low.\n\n## Recommendation:\n\n- Consider offering a configurable webserver choice\n- Consider configurable CSP",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-h29c-wcm8-883h",
                "link": "https://osv.dev/vulnerability/GHSA-h29c-wcm8-883h",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "2.3.1": {
        "info": {
            "author": "Micah Lee",
            "author_email": "micah@micahflee.com",
            "bugtrack_url": null,
            "classifiers": [
                "Environment :: Web Environment",
                "Framework :: Flask",
                "Intended Audience :: End Users/Desktop",
                "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
                "License :: Other/Proprietary License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.6",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9",
                "Topic :: Communications :: File Sharing",
                "Topic :: Security :: Cryptography"
            ],
            "description_content_type": "",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "GPLv3+",
            "maintainer": "",
            "maintainer_email": "",
            "name": "onionshare-cli",
            "package_url": "https://pypi.org/project/onionshare-cli/",
            "platform": "",
            "project_url": "https://pypi.org/project/onionshare-cli/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/onionshare-cli/2.3.1/",
            "requires_dist": [
                "click",
                "flask",
                "flask-httpauth",
                "flask-socketio",
                "psutil",
                "pycryptodome",
                "pysocks",
                "requests",
                "stem",
                "unidecode",
                "urllib3",
                "eventlet",
                "setuptools"
            ],
            "requires_python": ">=3.6,<4.0",
            "summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
            "version": "2.3.1",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15355783,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "66475cc7616c6a720d348c1114548f26",
                    "sha256": "ec24e617a874d39aaef957a60781f6cc6bd51fcb47fcd8d22f453acd2eff03e5"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.1-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "66475cc7616c6a720d348c1114548f26",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.6,<4.0",
                "size": 149072,
                "upload_time": "2021-02-22T22:14:26",
                "upload_time_iso_8601": "2021-02-22T22:14:26.271163Z",
                "url": "https://files.pythonhosted.org/packages/ec/37/b9cfacef031fe1bcb24da56bb662803a3e255ad6f642b702f31526308eb7/onionshare_cli-2.3.1-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "89663277e858fe16eca40e260fba01d6",
                    "sha256": "47320a5f270b3629586c249fb2ae1c2f67682cb53c5013a8af9702d0d6e50193"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.1.tar.gz",
                "has_sig": false,
                "md5_digest": "89663277e858fe16eca40e260fba01d6",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.6,<4.0",
                "size": 133526,
                "upload_time": "2021-02-22T22:14:28",
                "upload_time_iso_8601": "2021-02-22T22:14:28.298990Z",
                "url": "https://files.pythonhosted.org/packages/90/1c/5decebb3e6d6f45d5f773e0b515e553106ee6e963ccd9bd41a213202adfc/onionshare_cli-2.3.1.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [
                    "CVE-2022-21694",
                    "GHSA-h29c-wcm8-883h"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. The website mode of the onionshare allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-45",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-45",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689",
                    "GHSA-jh82-c5jw-pxpc"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions the receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script. An adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-40",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-40",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695",
                    "GHSA-99p8-9p2c-49j4"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions authenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants. This issue has been resolved in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-46",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-46",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690",
                    "GHSA-ch22-x2v3-v6vq"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions The path parameter of the requested URL is not sanitized before being passed to the QT frontend. This path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-41",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-41",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691",
                    "GHSA-w9m4-7w72-r766"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-42",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-42",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688",
                    "GHSA-x7wr-283h-5h2v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. Affected versions of the desktop application were found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. An adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated. This issue has been patched in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-39",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-39",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693",
                    "GHSA-jgm9-xpfj-4fq6"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions an adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced. This can be mitigated by usage of the flatpak release.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-44",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-44",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692",
                    "GHSA-gjj5-998g-v36v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions anyone with access to the chat environment can write messages disguised as another chat participant.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-43",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-43",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696",
                    "GHSA-68vr-8f46-vc9f"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions it is possible to change the username to that of another chat participant with an additional space character at the end of the name string. An adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-47",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-47",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-003\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nAnyone with access to the chat environment can write messages disguised as another chat participant.\n\n## Technical description:\n\nPrerequisites:\n\n- Alice and Bob are legitimate users\n- A third user has access to the chat environment\n\n![otf-003-a](https://user-images.githubusercontent.com/156128/140665707-1ecc897e-d33b-4f5b-b585-eb4475c1599f.png)\n\nThis screenshot shows Alice (`glimpse-depress`) and Bob (`blinker-doorpost`) joined a chatroom and are the only participants in the chatroom. Then the non-listed user squad-nursing writes a message in the chatroom without being visible in the list of users. The sending of the message itself is not required but was done here to show the initial access. The non-listed participant now renames himself to Bob and writes another message, seemingly coming from Bob.\n\nThis can be reproduced by slightly modifying the client-side JavaScript. The `joined` emit needs to be removed from the `socket.on(connect) `event handler. Therefore a client is not listed in the userlist and has no active session.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/resources/static/js/chat.js#L16-L18\n\nThis can be done either via a crafted client or runtime modification of the `chat.js` script in the browser's internal debugger.\n\nIt is still possible to call the text method and send text to the chat via websocket.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L131-L139\n\nIt is also possible to call the `update_username` function and choose an existing username from the chat.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L141-L162\n\nAfterwards the hidden user can send messages that are displayed as coming from the impersonated user. There is no way to distinguish between the fake and original message.\n\n## Impact:\n\nAn adversary with access to the chat environment can impersonate existing chat participants and write messages but not read the conversation. The similar exploit described in OTF-004 (page 19) has only slightly more requirements but also allows for reading.\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-gjj5-998g-v36v",
                "link": "https://osv.dev/vulnerability/GHSA-gjj5-998g-v36v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41868"
                ],
                "details": "OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to upload files on a non-public node when using the --receive functionality. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-7g47-xxff-9p85",
                "link": "https://osv.dev/vulnerability/GHSA-7g47-xxff-9p85",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-004\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nChat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.\n\n## Technical description:\n\n![otf-004-a](https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png)\n![otf-004-b](https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png)\n![otf-004-c](https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png)\n\nThis series of screenshots show Alice, Bob and Eve joined a chatroom and are the only participants in the chatroom. Eve seemingly leaves the chatroom, which leads Bob and Alice to believe they are having a private chat. The last screenshot shows that Eve only emitted the leave message and is still able to read the chat and possibly write messages.\n\nThis can be reproduced by joining the chat with two different instances, where one instance has slightly modified the client-side JavaScript code similar to OTF-003 (page 22). The joined emit needs to be removed from the connect event handler. Therefore the modified client is not listed in the userlist and has no active session. The modified non-listed user also needs to change their username to Eve, which is not shown in the chatroom. The modified client then emits the disconnect event and their connection is no longer usable.\n\nThis results in the leave message for Eve and the removal from the user-list but not in removal of the original session of the Eve who announced to join the chat.\n\n## Impact:\n\nAn adversary with access to the chat environment can spoof his leave event but still persist in the chat with access to all sent messages and the possibility to write in the chat using OTF-003 (page 22).\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-w9m4-7w72-r766",
                "link": "https://osv.dev/vulnerability/GHSA-w9m4-7w72-r766",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41867"
                ],
                "details": "An information disclosure vulnerability in OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to retrieve the full list of participants of a non-public OnionShare node via the --chat feature. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-6rvj-pw9w-jcvc",
                "link": "https://osv.dev/vulnerability/GHSA-6rvj-pw9w-jcvc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-009\n- Vulnerability type: Improper Access Control\n- Threat level: Low\n\n## Description:\n\nAuthenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants.\n\n## Technical description:\n\nPrerequisites:\n\n- Existing chatroom\n- Access to the chatroom (Public or known Private Key)\n- Either a modified frontend client or manual requests from burp/curl\n\nIf a user opens the chatroom without emitting the join message he will not be present in session.users[x] list. Therefore there is no listing in the frontend and no chat participant knows another party joined the chat. It is still possible to send messages in the chatroom.\n\nIf a user decides to abuse OTF-003 (page 22) he can impersonate messages from existing users; others would not be able to distinguish original and faked messages. This is also a prerequisite for OTF-004 (page 19).\n\n## Impact:\n\nAn adversary with access to the chat environment can send messages to the chat without being visible in the list of chat participants.\n\n## Recommendation:\n\n- Allow chat access only after emission of the join event.\n- Implement proper session handling.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-99p8-9p2c-49j4",
                "link": "https://osv.dev/vulnerability/GHSA-99p8-9p2c-49j4",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-001\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Elevated\n\n## Description:\n\nThe `path` parameter of the requested URL is not sanitized before being passed to the QT frontend.\n\n## Technical description:\n\nThe `path` parameter is not sanitized before being passed to the constructor of the `QLabel`.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/__init__.py#L499-L509\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/history.py#L456-L483\n\nhttps://doc.qt.io/qt-5/qlabel.html#details\n\n> Warning: When passing a QString to the constructor or calling setText(), make sure to sanitize your input, as QLabel tries to guess whether it displays the text as plain text or as rich text, a subset of HTML 4 markup. You may want to call setTextFormat() explicitly, e.g. in case you expect the text to be in plain format but cannot control the text source (for instance when displaying data loaded from the Web).\n\nThis path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.\n\nIn the following example an adversary injects a crafted image file into an Onionshare instance with receive mode and renders it in the history component of the Onionshare application.\n\nThe only requirement is another visit to the shared site with the following parameter attached to the path of the URL:\n\n```\n<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVQY02Nk+M+ABzAxMIxKYwIAQC0BEwZFOw4AAAAASUVORK5CYII=' />\n```\n\nThis will be rendered as a green square in the history tab where the path value is supposed to be (the value itself is shown at the bottom of the page).\n\n![otf-001](https://user-images.githubusercontent.com/156128/140665358-ab9e5990-3e13-4e50-85fd-b8a6e323d299.png)\n\nPossible scenarios where this could lead to remote code execution would be a 0-day in libpng or other internal image rendering (OTF-014 (page 12)) of the QT framework.\n\nThe QT documentation indicates that external files could be rendered, but we were unable to find a QT code path allowing for it.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can render arbitrary HTML (QT-HTML4 Subset) in the server desktop application. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Manually define the text format of the QLabel via `setTextFormat()`",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-ch22-x2v3-v6vq",
                "link": "https://osv.dev/vulnerability/GHSA-ch22-x2v3-v6vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-013\n- Vulnerability type: Improper Hardening\n- Threat level: Low\n\n## Description:\n\nThe filesystem restriction could be hardened and should only allow for pre-defined subfolders.\n\n## Technical description:\n\nThe Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are `onionshare/snap/snapcraft.yaml#L20` and `onionshare/flatpak/org.onionshare.OnionShare.yaml#L19` , respectively.\n\nThe encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.\n\nSadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.\n\n## Impact:\n\nAn adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.\n\n## Recommendation:\n\n- Reduce read access in Flatpak configuration.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jgm9-xpfj-4fq6",
                "link": "https://osv.dev/vulnerability/GHSA-jgm9-xpfj-4fq6",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/).\n\n- Vulnerability ID: OTF-012\n- Vulnerability type: Denial of Service\n- Threat level: Moderate\n\n## Description:\n\nThe receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script.\n\n## Technical description:\n\nThe following script uses GNU parallel and curl with around 6000 requests in parallel to send 10000 requests. A change in the `ulimit -n` configuration is required for it to work. This is sufficient to block file upload on a (public) receive instance.\n\n```\nseq 10000 | parallel --max-args 0 --jobs 6000 \"curl -i -s -x socks5h://localhost:9150 -k -X $'POST' -H $'Host: csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: multipart/form-data; boundary=---------------------------19182376703918074873375387042' -H $'Content-Length: 329' -H $'Connection: close' --data-binary $'-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"file[]\\\"; filename=\\\"poc.txt\\\"\\x0d\\x0aContent-Type: text/plain\\x0d\\x0a\\x0d\\x0aA\\x0d\\x0a-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"text\\\"\\x0d\\x0a\\x0d\\x0a\\x0d\\x0a-----------------------------19182376703918074873375387042--\\x0d\\x0a' $'http://csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion/upload-ajax'\"\n```\n\nAttack duration was around 80 seconds.\n\nCases where over 99 requests were sent per second:\n\n```\nEvery 0.1s: ls | grep...   onionvm: Tue Oct 5 12:17:00 2021\n78\n```\n\nCases where files were successfully written to disk:\n\n```\nEvery 0.1s: ls | wc -w   onionvm: Tue Oct 5 12:17:00 2021\n8399\n```\n\nThis means that during the attack time 1601 requests of 10000 were dropped. We tried to upload multiple files in the web interface during the attack and were not successful.\n\nThe failsafe is used to prevent creating more than 100 directories per second:\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/receive_mode.py#L386-L427\n\nThe limit of 100 requests/second is significantly lower than the possible network bandwidth and greatly reduces the attack complexity for denial of service. Our test was conducted over the tor network, which showed no limitation for the required bandwidth.\n\n## Impact:\n\nAn adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.\n\n## Recommendation:\n\n- Remove this limitation, or\n- Derive directory name from milliseconds\n",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jh82-c5jw-pxpc",
                "link": "https://osv.dev/vulnerability/GHSA-jh82-c5jw-pxpc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-014\n- Vulnerability type: Out-of-bounds Read\n- Threat level: Elevated\n\n## Description:\n\nThe desktop application was found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing.\n\n## Technical description:\n\nPrerequisites:\n\n- Onion address is known\n- Public service or authentication is valid\n- Desktop application is used\n- History is displayed\n\nThe rendering of images found in OTF-001 (page 25) could be elevated to a Denial of Service, which requires only very few bytes to be sent as a path parameter to any of the Onionshare functions. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. The issue is in the process of disclosure to the QT security mailing list. More details will be provided after a fixed QT build has been deployed.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Monitor for upstream fix\n- Fix OTF-001 (page 25) as a workaround",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-x7wr-283h-5h2v",
                "link": "https://osv.dev/vulnerability/GHSA-x7wr-283h-5h2v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-005\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Low\n\n## Description:\n\nIt is possible to change the username to that of another chat participant with an additional space character at the end of the name string.\n\n## Technical description:\n\nAssumed users in Chat:\n\n- Alice\n- Bob\n- Mallory\n\n1. Mallory renames to `Alice `.\n2. Mallory sends message as `Alice `.\n3. Alice and Bob receive a message from Mallory disguised as `Alice `, which is hard to distinguish from the `Alice`\nin the web interface.\n\n![otf-005-a](https://user-images.githubusercontent.com/156128/140666112-8febd4d8-6761-41aa-955c-48be76f3c657.png)\n![otf-005-b](https://user-images.githubusercontent.com/156128/140666113-1713ddf7-cef6-4dac-b718-9af1dc4ffdcd.png)\n\nOther (invisible) whitespace characters were found to be working as well.\n\n## Impact:\n\nAn adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.\n\n## Recommendation:\n\n- Remove non-visible characters from the username",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-68vr-8f46-vc9f",
                "link": "https://osv.dev/vulnerability/GHSA-68vr-8f46-vc9f",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21694"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-006\n- Vulnerability type: Broken Website Hardening Control\n- Threat level: Low\n\n## Description:\n\nThe CSP can be turned on or off but not configured for the specific needs of the website.\n\n## Technical description:\n\nThe website mode of the application allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.\n\nIf CSP were configurable, the website creator could harden it accordingly to the needs of the application.\n\nAs this issue correlates with the Github issue for exposing the flask application directly (https://github.com/onionshare/ onionshare/issues/1389), it can be assumed that this can be solved by either changing to a well-known webserver, which supports this kind of configuration, or enhancing the status quo by making the CSP a configurable part of each website.\n\nWe believe that bundling the nginx or apache webserver would add complexity and dependencies to the application that could result in a larger attack surface - as these packages receive regular security updates. On the other hand it is not recommended to directly expose the flask webserver, due to lack of hardening. This is a trade-off which needs to be evaluated by the Onionshare developers, as multiple features are involved. Ideally the application user could choose between the built-in flask webserver or a system webserver of choice.\n\n## Impact:\n\nAs this is a general weakness and not a direct vulnerability in the Onionshare application, the direct impact of this issue is rather low.\n\n## Recommendation:\n\n- Consider offering a configurable webserver choice\n- Consider configurable CSP",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-h29c-wcm8-883h",
                "link": "https://osv.dev/vulnerability/GHSA-h29c-wcm8-883h",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "2.3.2": {
        "info": {
            "author": "Micah Lee",
            "author_email": "micah@micahflee.com",
            "bugtrack_url": null,
            "classifiers": [
                "Environment :: Web Environment",
                "Framework :: Flask",
                "Intended Audience :: End Users/Desktop",
                "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
                "License :: Other/Proprietary License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.6",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9",
                "Topic :: Communications :: File Sharing",
                "Topic :: Security :: Cryptography"
            ],
            "description_content_type": "",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "GPLv3+",
            "maintainer": "",
            "maintainer_email": "",
            "name": "onionshare-cli",
            "package_url": "https://pypi.org/project/onionshare-cli/",
            "platform": "",
            "project_url": "https://pypi.org/project/onionshare-cli/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/onionshare-cli/2.3.2/",
            "requires_dist": [
                "click",
                "flask (>=1.1.4,<2.0.0)",
                "flask-httpauth",
                "flask-socketio (==5.0.1)",
                "psutil",
                "pycryptodome",
                "pysocks",
                "requests[socks] (>=2.25.1,<3.0.0)",
                "stem",
                "unidecode",
                "urllib3",
                "eventlet",
                "setuptools",
                "colorama (>=0.4.4,<0.5.0)"
            ],
            "requires_python": ">=3.6,<4.0",
            "summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
            "version": "2.3.2",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15355783,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "f8286db07c66130a53621cda7615be5e",
                    "sha256": "b937ffdf6020207da459090c38b93aa47250cbc9b07b6fb98438b0350c496540"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.2-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "f8286db07c66130a53621cda7615be5e",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.6,<4.0",
                "size": 153824,
                "upload_time": "2021-06-02T00:44:17",
                "upload_time_iso_8601": "2021-06-02T00:44:17.215238Z",
                "url": "https://files.pythonhosted.org/packages/2c/48/3f4950384f8637fbd42a3e9547a3e2dd055be85d6ad8db0da17a52ce4094/onionshare_cli-2.3.2-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "dfd226ce269b5c980306ee9a9ccc373e",
                    "sha256": "078063d8997cd6285765d277ad37f27bec04a81687fd7f54b8f0cfc279ff4658"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.2.tar.gz",
                "has_sig": false,
                "md5_digest": "dfd226ce269b5c980306ee9a9ccc373e",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.6,<4.0",
                "size": 137034,
                "upload_time": "2021-06-02T00:44:18",
                "upload_time_iso_8601": "2021-06-02T00:44:18.754343Z",
                "url": "https://files.pythonhosted.org/packages/9f/92/fc02d7a7aef60b69d361a0686edfc587692686671cd0b0b38fa7872b2225/onionshare_cli-2.3.2.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [
                    "CVE-2022-21694",
                    "GHSA-h29c-wcm8-883h"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. The website mode of the onionshare allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-45",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-45",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689",
                    "GHSA-jh82-c5jw-pxpc"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions the receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script. An adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-40",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-40",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695",
                    "GHSA-99p8-9p2c-49j4"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions authenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants. This issue has been resolved in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-46",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-46",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690",
                    "GHSA-ch22-x2v3-v6vq"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions The path parameter of the requested URL is not sanitized before being passed to the QT frontend. This path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-41",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-41",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691",
                    "GHSA-w9m4-7w72-r766"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-42",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-42",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688",
                    "GHSA-x7wr-283h-5h2v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. Affected versions of the desktop application were found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. An adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated. This issue has been patched in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-39",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-39",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693",
                    "GHSA-jgm9-xpfj-4fq6"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions an adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced. This can be mitigated by usage of the flatpak release.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-44",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-44",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692",
                    "GHSA-gjj5-998g-v36v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions anyone with access to the chat environment can write messages disguised as another chat participant.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-43",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-43",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696",
                    "GHSA-68vr-8f46-vc9f"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions it is possible to change the username to that of another chat participant with an additional space character at the end of the name string. An adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-47",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-47",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-003\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nAnyone with access to the chat environment can write messages disguised as another chat participant.\n\n## Technical description:\n\nPrerequisites:\n\n- Alice and Bob are legitimate users\n- A third user has access to the chat environment\n\n![otf-003-a](https://user-images.githubusercontent.com/156128/140665707-1ecc897e-d33b-4f5b-b585-eb4475c1599f.png)\n\nThis screenshot shows Alice (`glimpse-depress`) and Bob (`blinker-doorpost`) joined a chatroom and are the only participants in the chatroom. Then the non-listed user squad-nursing writes a message in the chatroom without being visible in the list of users. The sending of the message itself is not required but was done here to show the initial access. The non-listed participant now renames himself to Bob and writes another message, seemingly coming from Bob.\n\nThis can be reproduced by slightly modifying the client-side JavaScript. The `joined` emit needs to be removed from the `socket.on(connect) `event handler. Therefore a client is not listed in the userlist and has no active session.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/resources/static/js/chat.js#L16-L18\n\nThis can be done either via a crafted client or runtime modification of the `chat.js` script in the browser's internal debugger.\n\nIt is still possible to call the text method and send text to the chat via websocket.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L131-L139\n\nIt is also possible to call the `update_username` function and choose an existing username from the chat.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L141-L162\n\nAfterwards the hidden user can send messages that are displayed as coming from the impersonated user. There is no way to distinguish between the fake and original message.\n\n## Impact:\n\nAn adversary with access to the chat environment can impersonate existing chat participants and write messages but not read the conversation. The similar exploit described in OTF-004 (page 19) has only slightly more requirements but also allows for reading.\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-gjj5-998g-v36v",
                "link": "https://osv.dev/vulnerability/GHSA-gjj5-998g-v36v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41868"
                ],
                "details": "OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to upload files on a non-public node when using the --receive functionality. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-7g47-xxff-9p85",
                "link": "https://osv.dev/vulnerability/GHSA-7g47-xxff-9p85",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-004\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nChat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.\n\n## Technical description:\n\n![otf-004-a](https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png)\n![otf-004-b](https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png)\n![otf-004-c](https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png)\n\nThis series of screenshots show Alice, Bob and Eve joined a chatroom and are the only participants in the chatroom. Eve seemingly leaves the chatroom, which leads Bob and Alice to believe they are having a private chat. The last screenshot shows that Eve only emitted the leave message and is still able to read the chat and possibly write messages.\n\nThis can be reproduced by joining the chat with two different instances, where one instance has slightly modified the client-side JavaScript code similar to OTF-003 (page 22). The joined emit needs to be removed from the connect event handler. Therefore the modified client is not listed in the userlist and has no active session. The modified non-listed user also needs to change their username to Eve, which is not shown in the chatroom. The modified client then emits the disconnect event and their connection is no longer usable.\n\nThis results in the leave message for Eve and the removal from the user-list but not in removal of the original session of the Eve who announced to join the chat.\n\n## Impact:\n\nAn adversary with access to the chat environment can spoof his leave event but still persist in the chat with access to all sent messages and the possibility to write in the chat using OTF-003 (page 22).\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-w9m4-7w72-r766",
                "link": "https://osv.dev/vulnerability/GHSA-w9m4-7w72-r766",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41867"
                ],
                "details": "An information disclosure vulnerability in OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to retrieve the full list of participants of a non-public OnionShare node via the --chat feature. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-6rvj-pw9w-jcvc",
                "link": "https://osv.dev/vulnerability/GHSA-6rvj-pw9w-jcvc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-009\n- Vulnerability type: Improper Access Control\n- Threat level: Low\n\n## Description:\n\nAuthenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants.\n\n## Technical description:\n\nPrerequisites:\n\n- Existing chatroom\n- Access to the chatroom (Public or known Private Key)\n- Either a modified frontend client or manual requests from burp/curl\n\nIf a user opens the chatroom without emitting the join message he will not be present in session.users[x] list. Therefore there is no listing in the frontend and no chat participant knows another party joined the chat. It is still possible to send messages in the chatroom.\n\nIf a user decides to abuse OTF-003 (page 22) he can impersonate messages from existing users; others would not be able to distinguish original and faked messages. This is also a prerequisite for OTF-004 (page 19).\n\n## Impact:\n\nAn adversary with access to the chat environment can send messages to the chat without being visible in the list of chat participants.\n\n## Recommendation:\n\n- Allow chat access only after emission of the join event.\n- Implement proper session handling.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-99p8-9p2c-49j4",
                "link": "https://osv.dev/vulnerability/GHSA-99p8-9p2c-49j4",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-001\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Elevated\n\n## Description:\n\nThe `path` parameter of the requested URL is not sanitized before being passed to the QT frontend.\n\n## Technical description:\n\nThe `path` parameter is not sanitized before being passed to the constructor of the `QLabel`.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/__init__.py#L499-L509\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/history.py#L456-L483\n\nhttps://doc.qt.io/qt-5/qlabel.html#details\n\n> Warning: When passing a QString to the constructor or calling setText(), make sure to sanitize your input, as QLabel tries to guess whether it displays the text as plain text or as rich text, a subset of HTML 4 markup. You may want to call setTextFormat() explicitly, e.g. in case you expect the text to be in plain format but cannot control the text source (for instance when displaying data loaded from the Web).\n\nThis path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.\n\nIn the following example an adversary injects a crafted image file into an Onionshare instance with receive mode and renders it in the history component of the Onionshare application.\n\nThe only requirement is another visit to the shared site with the following parameter attached to the path of the URL:\n\n```\n<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVQY02Nk+M+ABzAxMIxKYwIAQC0BEwZFOw4AAAAASUVORK5CYII=' />\n```\n\nThis will be rendered as a green square in the history tab where the path value is supposed to be (the value itself is shown at the bottom of the page).\n\n![otf-001](https://user-images.githubusercontent.com/156128/140665358-ab9e5990-3e13-4e50-85fd-b8a6e323d299.png)\n\nPossible scenarios where this could lead to remote code execution would be a 0-day in libpng or other internal image rendering (OTF-014 (page 12)) of the QT framework.\n\nThe QT documentation indicates that external files could be rendered, but we were unable to find a QT code path allowing for it.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can render arbitrary HTML (QT-HTML4 Subset) in the server desktop application. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Manually define the text format of the QLabel via `setTextFormat()`",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-ch22-x2v3-v6vq",
                "link": "https://osv.dev/vulnerability/GHSA-ch22-x2v3-v6vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-013\n- Vulnerability type: Improper Hardening\n- Threat level: Low\n\n## Description:\n\nThe filesystem restriction could be hardened and should only allow for pre-defined subfolders.\n\n## Technical description:\n\nThe Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are `onionshare/snap/snapcraft.yaml#L20` and `onionshare/flatpak/org.onionshare.OnionShare.yaml#L19` , respectively.\n\nThe encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.\n\nSadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.\n\n## Impact:\n\nAn adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.\n\n## Recommendation:\n\n- Reduce read access in Flatpak configuration.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jgm9-xpfj-4fq6",
                "link": "https://osv.dev/vulnerability/GHSA-jgm9-xpfj-4fq6",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/).\n\n- Vulnerability ID: OTF-012\n- Vulnerability type: Denial of Service\n- Threat level: Moderate\n\n## Description:\n\nThe receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script.\n\n## Technical description:\n\nThe following script uses GNU parallel and curl with around 6000 requests in parallel to send 10000 requests. A change in the `ulimit -n` configuration is required for it to work. This is sufficient to block file upload on a (public) receive instance.\n\n```\nseq 10000 | parallel --max-args 0 --jobs 6000 \"curl -i -s -x socks5h://localhost:9150 -k -X $'POST' -H $'Host: csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: multipart/form-data; boundary=---------------------------19182376703918074873375387042' -H $'Content-Length: 329' -H $'Connection: close' --data-binary $'-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"file[]\\\"; filename=\\\"poc.txt\\\"\\x0d\\x0aContent-Type: text/plain\\x0d\\x0a\\x0d\\x0aA\\x0d\\x0a-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"text\\\"\\x0d\\x0a\\x0d\\x0a\\x0d\\x0a-----------------------------19182376703918074873375387042--\\x0d\\x0a' $'http://csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion/upload-ajax'\"\n```\n\nAttack duration was around 80 seconds.\n\nCases where over 99 requests were sent per second:\n\n```\nEvery 0.1s: ls | grep...   onionvm: Tue Oct 5 12:17:00 2021\n78\n```\n\nCases where files were successfully written to disk:\n\n```\nEvery 0.1s: ls | wc -w   onionvm: Tue Oct 5 12:17:00 2021\n8399\n```\n\nThis means that during the attack time 1601 requests of 10000 were dropped. We tried to upload multiple files in the web interface during the attack and were not successful.\n\nThe failsafe is used to prevent creating more than 100 directories per second:\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/receive_mode.py#L386-L427\n\nThe limit of 100 requests/second is significantly lower than the possible network bandwidth and greatly reduces the attack complexity for denial of service. Our test was conducted over the tor network, which showed no limitation for the required bandwidth.\n\n## Impact:\n\nAn adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.\n\n## Recommendation:\n\n- Remove this limitation, or\n- Derive directory name from milliseconds\n",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jh82-c5jw-pxpc",
                "link": "https://osv.dev/vulnerability/GHSA-jh82-c5jw-pxpc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-014\n- Vulnerability type: Out-of-bounds Read\n- Threat level: Elevated\n\n## Description:\n\nThe desktop application was found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing.\n\n## Technical description:\n\nPrerequisites:\n\n- Onion address is known\n- Public service or authentication is valid\n- Desktop application is used\n- History is displayed\n\nThe rendering of images found in OTF-001 (page 25) could be elevated to a Denial of Service, which requires only very few bytes to be sent as a path parameter to any of the Onionshare functions. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. The issue is in the process of disclosure to the QT security mailing list. More details will be provided after a fixed QT build has been deployed.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Monitor for upstream fix\n- Fix OTF-001 (page 25) as a workaround",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-x7wr-283h-5h2v",
                "link": "https://osv.dev/vulnerability/GHSA-x7wr-283h-5h2v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-005\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Low\n\n## Description:\n\nIt is possible to change the username to that of another chat participant with an additional space character at the end of the name string.\n\n## Technical description:\n\nAssumed users in Chat:\n\n- Alice\n- Bob\n- Mallory\n\n1. Mallory renames to `Alice `.\n2. Mallory sends message as `Alice `.\n3. Alice and Bob receive a message from Mallory disguised as `Alice `, which is hard to distinguish from the `Alice`\nin the web interface.\n\n![otf-005-a](https://user-images.githubusercontent.com/156128/140666112-8febd4d8-6761-41aa-955c-48be76f3c657.png)\n![otf-005-b](https://user-images.githubusercontent.com/156128/140666113-1713ddf7-cef6-4dac-b718-9af1dc4ffdcd.png)\n\nOther (invisible) whitespace characters were found to be working as well.\n\n## Impact:\n\nAn adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.\n\n## Recommendation:\n\n- Remove non-visible characters from the username",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-68vr-8f46-vc9f",
                "link": "https://osv.dev/vulnerability/GHSA-68vr-8f46-vc9f",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21694"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-006\n- Vulnerability type: Broken Website Hardening Control\n- Threat level: Low\n\n## Description:\n\nThe CSP can be turned on or off but not configured for the specific needs of the website.\n\n## Technical description:\n\nThe website mode of the application allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.\n\nIf CSP were configurable, the website creator could harden it accordingly to the needs of the application.\n\nAs this issue correlates with the Github issue for exposing the flask application directly (https://github.com/onionshare/ onionshare/issues/1389), it can be assumed that this can be solved by either changing to a well-known webserver, which supports this kind of configuration, or enhancing the status quo by making the CSP a configurable part of each website.\n\nWe believe that bundling the nginx or apache webserver would add complexity and dependencies to the application that could result in a larger attack surface - as these packages receive regular security updates. On the other hand it is not recommended to directly expose the flask webserver, due to lack of hardening. This is a trade-off which needs to be evaluated by the Onionshare developers, as multiple features are involved. Ideally the application user could choose between the built-in flask webserver or a system webserver of choice.\n\n## Impact:\n\nAs this is a general weakness and not a direct vulnerability in the Onionshare application, the direct impact of this issue is rather low.\n\n## Recommendation:\n\n- Consider offering a configurable webserver choice\n- Consider configurable CSP",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-h29c-wcm8-883h",
                "link": "https://osv.dev/vulnerability/GHSA-h29c-wcm8-883h",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "2.3.3": {
        "info": {
            "author": "Micah Lee",
            "author_email": "micah@micahflee.com",
            "bugtrack_url": null,
            "classifiers": [
                "Environment :: Web Environment",
                "Framework :: Flask",
                "Intended Audience :: End Users/Desktop",
                "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
                "License :: Other/Proprietary License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.6",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9",
                "Topic :: Communications :: File Sharing",
                "Topic :: Security :: Cryptography"
            ],
            "description_content_type": "",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "GPLv3+",
            "maintainer": "",
            "maintainer_email": "",
            "name": "onionshare-cli",
            "package_url": "https://pypi.org/project/onionshare-cli/",
            "platform": "",
            "project_url": "https://pypi.org/project/onionshare-cli/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/onionshare-cli/2.3.3/",
            "requires_dist": [
                "click",
                "flask (==1.1.4)",
                "flask-httpauth",
                "flask-socketio (==5.0.1)",
                "psutil",
                "pycryptodome",
                "pysocks",
                "requests[socks]",
                "stem",
                "unidecode",
                "urllib3",
                "eventlet",
                "setuptools",
                "colorama"
            ],
            "requires_python": ">=3.6,<4.0",
            "summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
            "version": "2.3.3",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15355783,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "f3014dd7cbecead8956dd7401ec7c33a",
                    "sha256": "39170f95638c8517c02c7354d278c435f703af72029f931f18a0680c0213ebf3"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.3-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "f3014dd7cbecead8956dd7401ec7c33a",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.6,<4.0",
                "size": 153817,
                "upload_time": "2021-08-20T22:45:11",
                "upload_time_iso_8601": "2021-08-20T22:45:11.957498Z",
                "url": "https://files.pythonhosted.org/packages/e7/87/8a830905c003480efd6cec7b266239255411faac8036afce4ed91a29a2a3/onionshare_cli-2.3.3-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "de80acd5807ebb636c66234c458989c5",
                    "sha256": "819f5da3096f38db48706a1f8ec2083653f94d3edd561601e47c9815cfbe8cb4"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.3.3.tar.gz",
                "has_sig": false,
                "md5_digest": "de80acd5807ebb636c66234c458989c5",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.6,<4.0",
                "size": 137128,
                "upload_time": "2021-08-20T22:45:14",
                "upload_time_iso_8601": "2021-08-20T22:45:14.017410Z",
                "url": "https://files.pythonhosted.org/packages/5f/00/495b6f669398822b525f9538a8dcef21a1f00a51611eb68c65a5ac23dd8b/onionshare_cli-2.3.3.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [
                    "CVE-2022-21694",
                    "GHSA-h29c-wcm8-883h"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. The website mode of the onionshare allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-45",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-45",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689",
                    "GHSA-jh82-c5jw-pxpc"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions the receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script. An adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-40",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-40",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695",
                    "GHSA-99p8-9p2c-49j4"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions authenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants. This issue has been resolved in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-46",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-46",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690",
                    "GHSA-ch22-x2v3-v6vq"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions The path parameter of the requested URL is not sanitized before being passed to the QT frontend. This path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-41",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-41",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691",
                    "GHSA-w9m4-7w72-r766"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-42",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-42",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688",
                    "GHSA-x7wr-283h-5h2v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. Affected versions of the desktop application were found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. An adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated. This issue has been patched in version 2.5.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-39",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-39",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693",
                    "GHSA-jgm9-xpfj-4fq6"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions an adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced. This can be mitigated by usage of the flatpak release.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-44",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-44",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692",
                    "GHSA-gjj5-998g-v36v"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions anyone with access to the chat environment can write messages disguised as another chat participant.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-43",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-43",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696",
                    "GHSA-68vr-8f46-vc9f"
                ],
                "details": "OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network. In affected versions it is possible to change the username to that of another chat participant with an additional space character at the end of the name string. An adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "PYSEC-2022-47",
                "link": "https://osv.dev/vulnerability/PYSEC-2022-47",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21692"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-003\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nAnyone with access to the chat environment can write messages disguised as another chat participant.\n\n## Technical description:\n\nPrerequisites:\n\n- Alice and Bob are legitimate users\n- A third user has access to the chat environment\n\n![otf-003-a](https://user-images.githubusercontent.com/156128/140665707-1ecc897e-d33b-4f5b-b585-eb4475c1599f.png)\n\nThis screenshot shows Alice (`glimpse-depress`) and Bob (`blinker-doorpost`) joined a chatroom and are the only participants in the chatroom. Then the non-listed user squad-nursing writes a message in the chatroom without being visible in the list of users. The sending of the message itself is not required but was done here to show the initial access. The non-listed participant now renames himself to Bob and writes another message, seemingly coming from Bob.\n\nThis can be reproduced by slightly modifying the client-side JavaScript. The `joined` emit needs to be removed from the `socket.on(connect) `event handler. Therefore a client is not listed in the userlist and has no active session.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/resources/static/js/chat.js#L16-L18\n\nThis can be done either via a crafted client or runtime modification of the `chat.js` script in the browser's internal debugger.\n\nIt is still possible to call the text method and send text to the chat via websocket.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L131-L139\n\nIt is also possible to call the `update_username` function and choose an existing username from the chat.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L141-L162\n\nAfterwards the hidden user can send messages that are displayed as coming from the impersonated user. There is no way to distinguish between the fake and original message.\n\n## Impact:\n\nAn adversary with access to the chat environment can impersonate existing chat participants and write messages but not read the conversation. The similar exploit described in OTF-004 (page 19) has only slightly more requirements but also allows for reading.\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-gjj5-998g-v36v",
                "link": "https://osv.dev/vulnerability/GHSA-gjj5-998g-v36v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41868"
                ],
                "details": "OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to upload files on a non-public node when using the --receive functionality. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-7g47-xxff-9p85",
                "link": "https://osv.dev/vulnerability/GHSA-7g47-xxff-9p85",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21691"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-004\n- Vulnerability type: Improper Access Control\n- Threat level: Moderate\n\n## Description:\n\nChat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.\n\n## Technical description:\n\n![otf-004-a](https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png)\n![otf-004-b](https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png)\n![otf-004-c](https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png)\n\nThis series of screenshots show Alice, Bob and Eve joined a chatroom and are the only participants in the chatroom. Eve seemingly leaves the chatroom, which leads Bob and Alice to believe they are having a private chat. The last screenshot shows that Eve only emitted the leave message and is still able to read the chat and possibly write messages.\n\nThis can be reproduced by joining the chat with two different instances, where one instance has slightly modified the client-side JavaScript code similar to OTF-003 (page 22). The joined emit needs to be removed from the connect event handler. Therefore the modified client is not listed in the userlist and has no active session. The modified non-listed user also needs to change their username to Eve, which is not shown in the chatroom. The modified client then emits the disconnect event and their connection is no longer usable.\n\nThis results in the leave message for Eve and the removal from the user-list but not in removal of the original session of the Eve who announced to join the chat.\n\n## Impact:\n\nAn adversary with access to the chat environment can spoof his leave event but still persist in the chat with access to all sent messages and the possibility to write in the chat using OTF-003 (page 22).\n\n## Recommendation:\n\n- Implement proper session handling",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-w9m4-7w72-r766",
                "link": "https://osv.dev/vulnerability/GHSA-w9m4-7w72-r766",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2021-41867"
                ],
                "details": "An information disclosure vulnerability in OnionShare 2.3 before 2.4 allows remote unauthenticated attackers to retrieve the full list of participants of a non-public OnionShare node via the --chat feature. ",
                "fixed_in": [
                    "2.4"
                ],
                "id": "GHSA-6rvj-pw9w-jcvc",
                "link": "https://osv.dev/vulnerability/GHSA-6rvj-pw9w-jcvc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21695"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-009\n- Vulnerability type: Improper Access Control\n- Threat level: Low\n\n## Description:\n\nAuthenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants.\n\n## Technical description:\n\nPrerequisites:\n\n- Existing chatroom\n- Access to the chatroom (Public or known Private Key)\n- Either a modified frontend client or manual requests from burp/curl\n\nIf a user opens the chatroom without emitting the join message he will not be present in session.users[x] list. Therefore there is no listing in the frontend and no chat participant knows another party joined the chat. It is still possible to send messages in the chatroom.\n\nIf a user decides to abuse OTF-003 (page 22) he can impersonate messages from existing users; others would not be able to distinguish original and faked messages. This is also a prerequisite for OTF-004 (page 19).\n\n## Impact:\n\nAn adversary with access to the chat environment can send messages to the chat without being visible in the list of chat participants.\n\n## Recommendation:\n\n- Allow chat access only after emission of the join event.\n- Implement proper session handling.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-99p8-9p2c-49j4",
                "link": "https://osv.dev/vulnerability/GHSA-99p8-9p2c-49j4",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21690"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-001\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Elevated\n\n## Description:\n\nThe `path` parameter of the requested URL is not sanitized before being passed to the QT frontend.\n\n## Technical description:\n\nThe `path` parameter is not sanitized before being passed to the constructor of the `QLabel`.\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/__init__.py#L499-L509\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/history.py#L456-L483\n\nhttps://doc.qt.io/qt-5/qlabel.html#details\n\n> Warning: When passing a QString to the constructor or calling setText(), make sure to sanitize your input, as QLabel tries to guess whether it displays the text as plain text or as rich text, a subset of HTML 4 markup. You may want to call setTextFormat() explicitly, e.g. in case you expect the text to be in plain format but cannot control the text source (for instance when displaying data loaded from the Web).\n\nThis path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.\n\nIn the following example an adversary injects a crafted image file into an Onionshare instance with receive mode and renders it in the history component of the Onionshare application.\n\nThe only requirement is another visit to the shared site with the following parameter attached to the path of the URL:\n\n```\n<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVQY02Nk+M+ABzAxMIxKYwIAQC0BEwZFOw4AAAAASUVORK5CYII=' />\n```\n\nThis will be rendered as a green square in the history tab where the path value is supposed to be (the value itself is shown at the bottom of the page).\n\n![otf-001](https://user-images.githubusercontent.com/156128/140665358-ab9e5990-3e13-4e50-85fd-b8a6e323d299.png)\n\nPossible scenarios where this could lead to remote code execution would be a 0-day in libpng or other internal image rendering (OTF-014 (page 12)) of the QT framework.\n\nThe QT documentation indicates that external files could be rendered, but we were unable to find a QT code path allowing for it.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can render arbitrary HTML (QT-HTML4 Subset) in the server desktop application. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Manually define the text format of the QLabel via `setTextFormat()`",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-ch22-x2v3-v6vq",
                "link": "https://osv.dev/vulnerability/GHSA-ch22-x2v3-v6vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21693"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-013\n- Vulnerability type: Improper Hardening\n- Threat level: Low\n\n## Description:\n\nThe filesystem restriction could be hardened and should only allow for pre-defined subfolders.\n\n## Technical description:\n\nThe Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are `onionshare/snap/snapcraft.yaml#L20` and `onionshare/flatpak/org.onionshare.OnionShare.yaml#L19` , respectively.\n\nThe encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.\n\nSadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.\n\n## Impact:\n\nAn adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.\n\n## Recommendation:\n\n- Reduce read access in Flatpak configuration.",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jgm9-xpfj-4fq6",
                "link": "https://osv.dev/vulnerability/GHSA-jgm9-xpfj-4fq6",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21689"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/).\n\n- Vulnerability ID: OTF-012\n- Vulnerability type: Denial of Service\n- Threat level: Moderate\n\n## Description:\n\nThe receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script.\n\n## Technical description:\n\nThe following script uses GNU parallel and curl with around 6000 requests in parallel to send 10000 requests. A change in the `ulimit -n` configuration is required for it to work. This is sufficient to block file upload on a (public) receive instance.\n\n```\nseq 10000 | parallel --max-args 0 --jobs 6000 \"curl -i -s -x socks5h://localhost:9150 -k -X $'POST' -H $'Host: csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: multipart/form-data; boundary=---------------------------19182376703918074873375387042' -H $'Content-Length: 329' -H $'Connection: close' --data-binary $'-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"file[]\\\"; filename=\\\"poc.txt\\\"\\x0d\\x0aContent-Type: text/plain\\x0d\\x0a\\x0d\\x0aA\\x0d\\x0a-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"text\\\"\\x0d\\x0a\\x0d\\x0a\\x0d\\x0a-----------------------------19182376703918074873375387042--\\x0d\\x0a' $'http://csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion/upload-ajax'\"\n```\n\nAttack duration was around 80 seconds.\n\nCases where over 99 requests were sent per second:\n\n```\nEvery 0.1s: ls | grep...   onionvm: Tue Oct 5 12:17:00 2021\n78\n```\n\nCases where files were successfully written to disk:\n\n```\nEvery 0.1s: ls | wc -w   onionvm: Tue Oct 5 12:17:00 2021\n8399\n```\n\nThis means that during the attack time 1601 requests of 10000 were dropped. We tried to upload multiple files in the web interface during the attack and were not successful.\n\nThe failsafe is used to prevent creating more than 100 directories per second:\n\nhttps://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/receive_mode.py#L386-L427\n\nThe limit of 100 requests/second is significantly lower than the possible network bandwidth and greatly reduces the attack complexity for denial of service. Our test was conducted over the tor network, which showed no limitation for the required bandwidth.\n\n## Impact:\n\nAn adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.\n\n## Recommendation:\n\n- Remove this limitation, or\n- Derive directory name from milliseconds\n",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-jh82-c5jw-pxpc",
                "link": "https://osv.dev/vulnerability/GHSA-jh82-c5jw-pxpc",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21688"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-014\n- Vulnerability type: Out-of-bounds Read\n- Threat level: Elevated\n\n## Description:\n\nThe desktop application was found to be vulnerable to denial of service via an undisclosed vulnerability in the QT image parsing.\n\n## Technical description:\n\nPrerequisites:\n\n- Onion address is known\n- Public service or authentication is valid\n- Desktop application is used\n- History is displayed\n\nThe rendering of images found in OTF-001 (page 25) could be elevated to a Denial of Service, which requires only very few bytes to be sent as a path parameter to any of the Onionshare functions. Roughly 20 bytes lead to 2GB memory consumption and this can be triggered multiple times. To be abused, this vulnerability requires rendering in the history tab, so some user interaction is required. The issue is in the process of disclosure to the QT security mailing list. More details will be provided after a fixed QT build has been deployed.\n\n## Impact:\n\nAn adversary with knowledge of the Onion service address in public mode or with authentication in private mode can perform a Denial of Service attack, which quickly results in out-of-memory for the server. This requires the desktop application with rendered history, therefore the impact is only elevated.\n\n## Recommendation:\n\n- Monitor for upstream fix\n- Fix OTF-001 (page 25) as a workaround",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-x7wr-283h-5h2v",
                "link": "https://osv.dev/vulnerability/GHSA-x7wr-283h-5h2v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21696"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-005\n- Vulnerability type: Improper Input Sanitization\n- Threat level: Low\n\n## Description:\n\nIt is possible to change the username to that of another chat participant with an additional space character at the end of the name string.\n\n## Technical description:\n\nAssumed users in Chat:\n\n- Alice\n- Bob\n- Mallory\n\n1. Mallory renames to `Alice `.\n2. Mallory sends message as `Alice `.\n3. Alice and Bob receive a message from Mallory disguised as `Alice `, which is hard to distinguish from the `Alice`\nin the web interface.\n\n![otf-005-a](https://user-images.githubusercontent.com/156128/140666112-8febd4d8-6761-41aa-955c-48be76f3c657.png)\n![otf-005-b](https://user-images.githubusercontent.com/156128/140666113-1713ddf7-cef6-4dac-b718-9af1dc4ffdcd.png)\n\nOther (invisible) whitespace characters were found to be working as well.\n\n## Impact:\n\nAn adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.\n\n## Recommendation:\n\n- Remove non-visible characters from the username",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-68vr-8f46-vc9f",
                "link": "https://osv.dev/vulnerability/GHSA-68vr-8f46-vc9f",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [
                    "CVE-2022-21694"
                ],
                "details": "Between September 26, 2021 and October 8, 2021, [Radically Open Security](https://www.radicallyopensecurity.com/) conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's [Red Team lab](https://www.opentech.fund/labs/red-team-lab/). This is an issue from that penetration test.\n\n- Vulnerability ID: OTF-006\n- Vulnerability type: Broken Website Hardening Control\n- Threat level: Low\n\n## Description:\n\nThe CSP can be turned on or off but not configured for the specific needs of the website.\n\n## Technical description:\n\nThe website mode of the application allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.\n\nIf CSP were configurable, the website creator could harden it accordingly to the needs of the application.\n\nAs this issue correlates with the Github issue for exposing the flask application directly (https://github.com/onionshare/ onionshare/issues/1389), it can be assumed that this can be solved by either changing to a well-known webserver, which supports this kind of configuration, or enhancing the status quo by making the CSP a configurable part of each website.\n\nWe believe that bundling the nginx or apache webserver would add complexity and dependencies to the application that could result in a larger attack surface - as these packages receive regular security updates. On the other hand it is not recommended to directly expose the flask webserver, due to lack of hardening. This is a trade-off which needs to be evaluated by the Onionshare developers, as multiple features are involved. Ideally the application user could choose between the built-in flask webserver or a system webserver of choice.\n\n## Impact:\n\nAs this is a general weakness and not a direct vulnerability in the Onionshare application, the direct impact of this issue is rather low.\n\n## Recommendation:\n\n- Consider offering a configurable webserver choice\n- Consider configurable CSP",
                "fixed_in": [
                    "2.5"
                ],
                "id": "GHSA-h29c-wcm8-883h",
                "link": "https://osv.dev/vulnerability/GHSA-h29c-wcm8-883h",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "2.5": {
        "info": {
            "author": "Micah Lee",
            "author_email": "micah@micahflee.com",
            "bugtrack_url": null,
            "classifiers": [
                "Environment :: Web Environment",
                "Framework :: Flask",
                "Intended Audience :: End Users/Desktop",
                "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
                "License :: Other/Proprietary License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.6",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9",
                "Topic :: Communications :: File Sharing",
                "Topic :: Security :: Cryptography"
            ],
            "description_content_type": "",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "GPLv3+",
            "maintainer": "",
            "maintainer_email": "",
            "name": "onionshare-cli",
            "package_url": "https://pypi.org/project/onionshare-cli/",
            "platform": "",
            "project_url": "https://pypi.org/project/onionshare-cli/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/onionshare-cli/2.5/",
            "requires_dist": [
                "click",
                "flask (==1.1.4)",
                "flask-socketio (==5.0.1)",
                "psutil",
                "pysocks",
                "requests[socks]",
                "unidecode",
                "urllib3",
                "eventlet",
                "setuptools",
                "pynacl",
                "colorama",
                "gevent-websocket",
                "cepa (==1.8.3)"
            ],
            "requires_python": ">=3.6,<4.0",
            "summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
            "version": "2.5",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15355783,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "6ed3e129728d6629aec5874697f0b527",
                    "sha256": "a3ded566d80e32a8d6493666c1a3662312b14057fb8b585f028e08466b51ce6d"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.5-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "6ed3e129728d6629aec5874697f0b527",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.6,<4.0",
                "size": 159267,
                "upload_time": "2022-01-17T22:38:48",
                "upload_time_iso_8601": "2022-01-17T22:38:48.685616Z",
                "url": "https://files.pythonhosted.org/packages/fc/d1/ef1bae4975ae09966607dba7d095cd5684e3009c7dd4c699b632f3e099ce/onionshare_cli-2.5-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "982f2c72a202ee9286cbfddfcac355e8",
                    "sha256": "3f7da94e45671142f62edc15990bf22819a026d5555d926a182c38095ac96b90"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.5.tar.gz",
                "has_sig": false,
                "md5_digest": "982f2c72a202ee9286cbfddfcac355e8",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.6,<4.0",
                "size": 140427,
                "upload_time": "2022-01-17T22:38:50",
                "upload_time_iso_8601": "2022-01-17T22:38:50.229115Z",
                "url": "https://files.pythonhosted.org/packages/a4/2f/b6b0f83519a3cbe2a0687b26c295ab83cebd88ec99448e8743f3cfdca246/onionshare_cli-2.5.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    },
    "2.6": {
        "info": {
            "author": "Micah Lee",
            "author_email": "micah@micahflee.com",
            "bugtrack_url": null,
            "classifiers": [
                "Environment :: Web Environment",
                "Framework :: Flask",
                "Intended Audience :: End Users/Desktop",
                "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
                "License :: Other/Proprietary License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9",
                "Topic :: Communications :: File Sharing",
                "Topic :: Security :: Cryptography"
            ],
            "description": "",
            "description_content_type": null,
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "GPLv3+",
            "maintainer": "",
            "maintainer_email": "",
            "name": "onionshare-cli",
            "package_url": "https://pypi.org/project/onionshare-cli/",
            "platform": null,
            "project_url": "https://pypi.org/project/onionshare-cli/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/onionshare-cli/2.6/",
            "requires_dist": [
                "click",
                "flask (==2.0.3)",
                "flask-socketio (==5.3.1)",
                "psutil",
                "pysocks",
                "requests[socks]",
                "unidecode",
                "urllib3",
                "eventlet",
                "setuptools",
                "pynacl",
                "colorama",
                "gevent-websocket",
                "stem (==1.8.1)",
                "werkzeug (>=2.0.3,<2.1.0)"
            ],
            "requires_python": ">=3.7,<4.0",
            "summary": "OnionShare lets you securely and anonymously send and receive files. It works by starting a web server, making it accessible as a Tor onion service, and generating an unguessable web address so others can download files from you, or upload files to you. It does _not_ require setting up a separate server or using a third party file-sharing service.",
            "version": "2.6",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15355783,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "07ebcdad1ef9fd3b491786c1d6c13bc2",
                    "sha256": "2df478fe4e318001a2eab2417775cea2df1d42919548dddc89add98ffcff963c"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.6-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "07ebcdad1ef9fd3b491786c1d6c13bc2",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.7,<4.0",
                "size": 176732,
                "upload_time": "2022-10-10T00:36:50",
                "upload_time_iso_8601": "2022-10-10T00:36:50.497400Z",
                "url": "https://files.pythonhosted.org/packages/dd/ec/8c48f903391eb55b41016b362791367f011be7045f0a5fb567679d8ee6ed/onionshare_cli-2.6-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "fcb588cb4d9905addcfceb3793635600",
                    "sha256": "244c8c018b1dc8e05c7b6403a197490c4897b9bead61837ddeb7140bb4e40157"
                },
                "downloads": -1,
                "filename": "onionshare_cli-2.6.tar.gz",
                "has_sig": false,
                "md5_digest": "fcb588cb4d9905addcfceb3793635600",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.7,<4.0",
                "size": 157290,
                "upload_time": "2022-10-10T00:36:53",
                "upload_time_iso_8601": "2022-10-10T00:36:53.125515Z",
                "url": "https://files.pythonhosted.org/packages/d7/cf/4270d541a4f7916d67cd66b43c30e1f0fd2c52b0d533a170742af192fdc9/onionshare_cli-2.6.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}