{
    "1.4": {
        "info": {
            "author": "",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "Development Status :: 4 - Beta",
                "Environment :: Web Environment",
                "Intended Audience :: Developers",
                "License :: OSI Approved :: MIT License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Topic :: Internet :: WWW/HTTP :: Dynamic Content",
                "Topic :: Internet :: WWW/HTTP :: WSGI",
                "Topic :: Internet :: WWW/HTTP :: WSGI :: Application",
                "Topic :: Software Development :: Libraries :: Application Frameworks"
            ],
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "",
            "maintainer": "",
            "maintainer_email": "",
            "name": "wangankeji-sso",
            "package_url": "https://pypi.org/project/wangankeji-sso/",
            "platform": null,
            "project_url": "https://pypi.org/project/wangankeji-sso/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/wangankeji-sso/1.4/",
            "requires_dist": [
                "requests (>=2.21.0)",
                "pycryptodome (>=3.10.1)"
            ],
            "requires_python": ">=3.5",
            "summary": "SSO client for wangankeji sso.",
            "version": "1.4",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 13281939,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "3cfed44d02b05c41c2693ed79e25f894",
                    "sha256": "ff806071eb3f53b9411a62c96a44dea8ab24436cb359c614f18e1455f62c1a17"
                },
                "downloads": -1,
                "filename": "wangankeji_sso-1.4-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "3cfed44d02b05c41c2693ed79e25f894",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.5",
                "size": 17534,
                "upload_time": "2022-03-15T09:41:17",
                "upload_time_iso_8601": "2022-03-15T09:41:17.654261Z",
                "url": "https://files.pythonhosted.org/packages/30/88/ff3f435be8238c192e66745ceec4914a03a82722561866c527040fc5b5ae/wangankeji_sso-1.4-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "36e41e5ca7f880c6b08b34173d4e524e",
                    "sha256": "186f23e46f97a57443d828ff36ab22cc97cd3c5af969100f78775cb3a2aa7925"
                },
                "downloads": -1,
                "filename": "wangankeji_sso-1.4.tar.gz",
                "has_sig": false,
                "md5_digest": "36e41e5ca7f880c6b08b34173d4e524e",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.5",
                "size": 15937,
                "upload_time": "2022-03-15T09:41:19",
                "upload_time_iso_8601": "2022-03-15T09:41:19.502207Z",
                "url": "https://files.pythonhosted.org/packages/c8/3a/2d9ca26ace5e0266040b4c6025a60a411da68e4ae31248ea20e5d3429fb9/wangankeji_sso-1.4.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    },
    "1.5.1": {
        "info": {
            "author": "",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "Development Status :: 4 - Beta",
                "Environment :: Web Environment",
                "Intended Audience :: Developers",
                "License :: OSI Approved :: MIT License",
                "Operating System :: OS Independent",
                "Programming Language :: Python :: 3",
                "Topic :: Internet :: WWW/HTTP :: Dynamic Content",
                "Topic :: Internet :: WWW/HTTP :: WSGI",
                "Topic :: Internet :: WWW/HTTP :: WSGI :: Application",
                "Topic :: Software Development :: Libraries :: Application Frameworks"
            ],
            "description": "# \u7f51\u5b89 SSO \u5ba2\u6237\u7aef\n\n\u793a\u4f8b\u89c1 [sample.py](./sample.py)\n\n## \u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\n\n- \u63d0\u4f9b\u901a\u4fe1\u63a5\u53e3\n    - \u4f1a\u6821\u9a8c\u8bf7\u6c42\u5934\uff08\u52a0\u5bc6\u4f20\u8f93\uff09\n    - \u63a5\u6536\u7528\u6237\u7684\u7ed1\u5b9a/\u89e3\u7ed1\n    - \u63a5\u6536\u7528\u6237\u7684\u767b\u5f55\u6821\u9a8c\n- \u63d0\u4f9b\u767b\u5f55\u63a5\u53e3\n    - \u4e0d\u6821\u9a8c\u8bf7\u6c42\u5934\n    - \u5b58\u50a8\u767b\u5f55\u7684 session\u3001cookie\n- \u5b9a\u671f\u68c0\u67e5\u5f53\u524d\u7528\u6237\u7684\u767b\u5f55\u72b6\u6001\n    - token \u662f\u5426\u4ecd\u7136\u5b58\u6d3b\n- \u9000\u51fa\u65f6\u5411SSO\u53d1\u901a\u77e5\n\n### \u5b9e\u73b0\u63cf\u8ff0\n\n\u6b64\u8282\u70b9\u4f1a\u63cf\u8ff0\uff1a\u5f53\u7cfb\u7edf\u9700\u8981\u63a5\u5165\u65f6\uff0c\u529f\u80fd\u5b9e\u73b0\u7684\u7ec6\u8282\u3002\n\n\u5e94\u7528\u5185\u9700\u8981\u63d0\u4f9b\u4ee5\u4e0b\u5185\u4e2a\u5730\u5740:\n\n- \u901a\u4fe1\u63a5\u53e3\u5730\u5740 \u7528\u4e8e\u5904\u7406\u5e94\u7528\u4e0eSSO\u95f4\u6570\u636e\u4ea4\u6362\u7684\u5730\u5740\n- \u767b\u5f55\u63a5\u53e3\u5730\u5740 \u7528\u4e8e\u5904\u7406\u5e94\u7528\u767b\u5f55\u72b6\u6001\uff08\u4e00\u822c\u7528\u4e8e\u5c06\u767b\u5f55\u4fe1\u606f\u5199\u5165 session/cookie\uff09\uff0c\u5b8c\u6210\u540e\u5e94\u5f53\u8f6c\u5230 **\u4e3b\u9875\u5730\u5740**\n- \u4e3b\u9875\u5730\u5740 **\u767b\u5f55\u63a5\u53e3\u5730\u5740** \u5904\u7406\u5b8c\u6210\u540e\uff0c\u9700\u8981\u8df3\u8f6c\u5230\u7684\u5730\u5740\n- \u767b\u5f55\u5730\u5740 \u767b\u5f55\u8bf7\u6c42\u5931\u8d25\u6216\u63a5\u53e3\u5904\u7406\u5931\u8d25\u540e\u7684\u8df3\u8f6c\u5730\u5740\n\n#### \u63d0\u4f9b\u901a\u4fe1\u63a5\u53e3\n\n```python\nfrom wangankeji_sso.client import AbstractSsoRequestHandler, SsoToken, SsoErrorCodes\nfrom typing import Optional, List\n\n\nclass MySsoRequestHandler(AbstractSsoRequestHandler):\n  def get_user(self, user_id: str) -> Optional[dict]:\n    \"\"\"\n    \u53ef\u9009\u5b9e\u73b0\n    \"\"\"\n    pass\n\n  def get_all_users(self) -> List[dict]:\n    \"\"\"\n    \u82e5\u5e94\u7528\u5185\u5b58\u5728\u7528\u6237\u4f53\u7cfb\n    \u5e76\u4e14:\n        1. \u9700\u8981\u8fdb\u884c\u7528\u6237\u7ed1\u5b9a\uff08\u6821\u9a8c\u7528\u6237\u540d\u5bc6\u7801\uff09\n        2. \u9700\u8981\u901a\u8fc7\u6b64\u7cfb\u7edf\u6821\u9a8c\u767b\u5f55\uff08\u6821\u9a8c\u7528\u6237\u662f\u5426\u53ef\u7528\uff09\n    \u90a3\u4e48\u5fc5\u987b\u5b9e\u73b0\u6b64\u63a5\u53e3\n    \"\"\"\n    # \u6570\u636e\u7ed3\u6784:\n    # [{\n    #     'uid': \u7528\u6237ID,\n    #     'uname': \u7528\u6237\u540d,\n    #     'user_rid': \u7528\u6237\u89d2\u8272ID\u5217\u8868\uff0c\u591a\u4e2aID\u4f7f\u7528\u9017\u53f7\u5206\u9694,\n    #     'ext': []\n    # }]\n    pass\n\n  def get_role(self, role_id: str) -> Optional[dict]:\n    \"\"\"\n    \u53ef\u9009\u5b9e\u73b0\n    \"\"\"\n    pass\n\n  def get_all_roles(self) -> List[dict]:\n    \"\"\"\n    \u82e5\u5e94\u7528\u5185\u5b58\u5728\u7528\u6237\u4f53\u7cfb\n    \u5e76\u4e14:\n        1. \u9700\u8981\u8fdb\u884c\u7528\u6237\u7ed1\u5b9a\uff08\u6821\u9a8c\u7528\u6237\u540d\u5bc6\u7801\uff09\n        2. \u9700\u8981\u901a\u8fc7\u6b64\u7cfb\u7edf\u6821\u9a8c\u767b\u5f55\uff08\u6821\u9a8c\u7528\u6237\u662f\u5426\u53ef\u7528\uff09\n    \u90a3\u4e48\u5fc5\u987b\u5b9e\u73b0\u6b64\u63a5\u53e3\n    \"\"\"\n    # \u6570\u636e\u7ed3\u6784:\n    # [{\n    #     'rid': \u89d2\u8272ID,\n    #     'rname': \u89d2\u8272\u540d,\n    #     'ext': []\n    # }]\n    pass\n\n  def do_login(self, token: SsoToken) -> SsoErrorCodes:\n    \"\"\"\n    \u8fdb\u884c\u7528\u6237\u6821\u9a8c\uff08\u4e3b\u8981\u662f\u7528\u6237\u72b6\u6001\u7684\u6821\u9a8c\uff0c\u6bd4\u5982\uff1a\u7528\u6237\u5df2\u7ecf\u88ab\u5220\u9664\uff0c\u7528\u6237\u88ab\u7981\u7528\u7b49\uff09\n    \"\"\"\n    return SsoErrorCodes.NONE\n\n  def do_logout(self, token: SsoToken):\n    \"\"\"\n    \u53ef\u9009\u5b9e\u73b0\n    \"\"\"\n    pass\n\n  def do_bind(self, sso_uid: str, app_uid: str, app_uname: str, password: str) -> SsoErrorCodes:\n    \"\"\"\n    \u8fdb\u884c\u7528\u6237\u6821\u9a8c\n    1. \u7528\u6237\u5bc6\u7801\u662f\u5426\u6b63\u786e\n    2. \u7528\u6237\u72b6\u6001\u7684\u6821\u9a8c\uff0c\u6bd4\u5982\uff1a\u7528\u6237\u5df2\u7ecf\u88ab\u5220\u9664\uff0c\u7528\u6237\u88ab\u7981\u7528\u7b49\n    \"\"\"\n    return SsoErrorCodes.NONE\n\n  def do_unbind(self, sso_uid: str, app_uid: str, app_uname: str) -> SsoErrorCodes:\n    \"\"\"\n    \u53ef\u9009\u5b9e\u73b0\n    \"\"\"\n    return SsoErrorCodes.NONE\n```\n\n#### \u5b9e\u4f8b\u5316\u5ba2\u6237\u7aef\n\n```python\nfrom wangankeji_sso.client import Sso, SsoOption\n\noption = SsoOption()\n# \u5e94\u7528\u7684 APPID\n# option.app_id = SSO_APP_ID\n# SSO \u7684\u901a\u4fe1\u5730\u5740\n# option.sso_url = SSO_URL\n# SSO RSA \u516c\u94a5\uff08\u6ce8\u610f\uff1a\u6b64\u516c\u94a5\u4ec5\u53ef\u7528\u4e8e\u5355\u4e00\u5e94\u7528\uff0c\u591a\u4e2a\u5e94\u7528\u65e0\u6cd5\u901a\u7528\uff09\n# option.sso_public_key = SSO_PUB_KEY\n# \u5e94\u7528RSA\u79c1\u94a5\n# option.app_private_key = APP_PRIV_KEY\n\nsso = Sso(option, MySsoRequestHandler())\n```\n\n#### \u767b\u5f55\u63a5\u53e3\n\n\u793a\u4f8b\u5982\u4e0b:\n\n```python\nfrom wangankeji_sso.client import SsoToken\nfrom wangankeji_sso.client.utils import Rsa\n\n\ndef post(request, token: str, main_url: str, login_url: str):\n  \"\"\"\n\n  :param request: \u8bf7\u6c42\u5bf9\u8c61\n  :param token: \u4f7f\u7528SSO\u516c\u94a5\u52a0\u5bc6\u7684TOKEN\n  :param main_url: \u4e3b\u9875\u5730\u5740\n  :param login_url: \u767b\u5f55\u9875\u5730\u5740\n  :return:\n  \"\"\"\n  try:\n    # \u89e3\u5bc6\u51fa\u660e\u6587\u7684 token\n    clear_token = SsoToken.parse(Rsa.decrypt(token, options.APP_PRIV_KEY))\n    if not clear_token:\n      raise Exception('TOKEN \u6570\u636e\u65e0\u6548')\n  except Exception as ex:\n    return HttpResponse('\u65e0\u6cd5\u89e3\u7801 TOKEN')\n\n  # \u4f7f\u7528 token\uff0c\u8bbe\u7f6e\u5f53\u524d\u7684\u767b\u5f55\u72b6\u6001\n  try:\n    # \u5e94\u7528\u5185\u7684\u767b\u5f55\u6d41\u7a0b\n    # \u6dfb\u52a0\u4e00\u4e2a\u767b\u5f55\u65b9\u5f0f\u7684\u6807\u8bb0\n    session['login-by-wa-sso'] = 1\n    session['wa-sso-token'] = str(clear_token)\n    redirect_url = main_url\n  except Exception as ex:\n    redirect_url = login_url\n  return Redirect(redirect_url)\n```\n\n#### \u68c0\u67e5\u767b\u5f55\u72b6\u6001\n\n\u5efa\u8bae\u5728\u5e94\u7528\u7684\u4e2d\u95f4\u4ef6\u4e0a\uff0c\u6dfb\u52a0\u767b\u5f55\u72b6\u6001\u7684\u7684\u68c0\u67e5\u3002\uff08\u4e3a\u4e86\u51cf\u8f7b\u8d44\u6e90\u6d88\u8017\uff0c\u5efa\u8bae\u7f13\u5b58\u68c0\u67e5\u7ed3\u679c\uff09\n\n```python\nif session.get('login-by-wa-sso') == 1:\n    # \u662f\u4ece sso \u767b\u5f55\u7684\n    token = session.get('wa-sso-token')\n    # sso \u6765\u81ea\u5ba2\u6237\u7aef\u5b9e\u4f8b\n    if not sso.client.check_login(token):\n        session.remove('login-by-wa-sso')\n        session.remove('wa-sso-token')\n        return HttpResponse('\u767b\u5f55\u5df2\u7ecf\u8d85\u65f6')\n```\n\n\n",
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "",
            "maintainer": "",
            "maintainer_email": "",
            "name": "wangankeji-sso",
            "package_url": "https://pypi.org/project/wangankeji-sso/",
            "platform": null,
            "project_url": "https://pypi.org/project/wangankeji-sso/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/wangankeji-sso/1.5.1/",
            "requires_dist": [
                "requests (>=2.21.0)",
                "pycryptodome (>=3.10.1)"
            ],
            "requires_python": ">=3.5",
            "summary": "SSO client for wangankeji sso.",
            "version": "1.5.1",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 13281939,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "f4dbd3d859c3898ca495dab2aa964f2a",
                    "sha256": "52d9c8a63803dc50d7058805064e10474274b5a6ca9097d242668d6ea9ba89e4"
                },
                "downloads": -1,
                "filename": "wangankeji_sso-1.5.1-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "f4dbd3d859c3898ca495dab2aa964f2a",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.5",
                "size": 17959,
                "upload_time": "2022-03-24T12:44:04",
                "upload_time_iso_8601": "2022-03-24T12:44:04.988173Z",
                "url": "https://files.pythonhosted.org/packages/18/50/e6b3bf110970e02e558a2c5f36818f39b7001a09dcbcc02dd0b1dc1e5a39/wangankeji_sso-1.5.1-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "71227e368be0499d0059c021080ada4d",
                    "sha256": "08619e61f62da5158936336e2dd3261cfb6d4dceaa42d39f25bceb56ce4d89eb"
                },
                "downloads": -1,
                "filename": "wangankeji_sso-1.5.1.tar.gz",
                "has_sig": false,
                "md5_digest": "71227e368be0499d0059c021080ada4d",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.5",
                "size": 16317,
                "upload_time": "2022-03-24T12:44:07",
                "upload_time_iso_8601": "2022-03-24T12:44:07.005970Z",
                "url": "https://files.pythonhosted.org/packages/41/d1/9a5bb54fb7ddfd3b57ecdd1f8e2ea4f295549e93463947db072a75e329a0/wangankeji_sso-1.5.1.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}