{
    "0.2.0": {
        "info": {
            "author": "",
            "author_email": "BlueGlassBlock <blueglassblock@outlook.com>,Red_lnn <w731347477@gmail.com>",
            "bugtrack_url": null,
            "classifiers": [],
            "description": "<div align=\"center\">\n\n# GraiaX FastAPI\n\n> :sparkles: Easy FastAPI Access for GraiaCommunity :sparkles:\n\n[![codecov](https://codecov.io/gh/GraiaCommunity/graiax-fastapi/branch/master/graph/badge.svg?token=IU7kXPfTsV)](https://codecov.io/gh/GraiaCommunity/graiax-fastapi)\n[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)\n[![Imports: isort](https://img.shields.io/badge/%20imports-isort-%231674b1?style=flat&labelColor=ef8336)](https://pycqa.github.io/isort/)\n[![License](https://img.shields.io/github/license/GraiaCommunity/graiax-fastapi)](https://github.com/GraiaCommunity/graiax-fastapi/blob/master/LICENSE)\n[![pdm-managed](https://img.shields.io/badge/pdm-managed-blueviolet)](https://pdm.fming.dev)\n[![PyPI](https://img.shields.io/pypi/v/graiax-fastapi)](https://img.shields.io/pypi/v/graiax-fastapi)\n\n</div>\n\n\u4f60\u53ef\u4ee5\u65b9\u4fbf\u5730\u4f7f\u7528 GraiaX FastAPI \u914d\u5408 `graia.amnesia.builtins.uvicorn.UvicornService`\n\u8f7b\u677e\u5730\u5728\u542f\u52a8\u4f7f\u7528\u4e86 Graia Amnesia \u7684\u9879\u76ee\uff08\u5982\uff1aAriadne\u3001Avilla\uff09\u7684\u540c\u65f6\u542f\u52a8\u4e00\u4e2a\nUvicorn \u670d\u52a1\u5668\u5e76\u628a FastAPI \u4f5c\u4e3a\u5176 `ASGIApplication`\uff0c\u5e76\u5728\u5176\u9000\u51fa\u7684\u65f6\u5019\u81ea\u52a8\u5173\u95ed Uvicorn\u3002\n\n## \u5b89\u88c5\n\n`pdm add graiax-fastapi` \u6216 `poetry add graiax-fastapi`\u3002\n\n> \u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528\u5305\u7ba1\u7406\u5668\u6216\u865a\u62df\u73af\u5883\n\n## \u5f00\u59cb\u4f7f\u7528\n\n\u4ee5 Ariadne \u4e3a\u4f8b\u3002\n\n### \u914d\u5408 Launart \u4f7f\u7528\n\n#### \u673a\u5668\u4eba\u5165\u53e3\u6587\u4ef6\n\n\u5982\u679c\u4f60\u6709\u4f7f\u7528 **Graia Saya** \u4f5c\u4e3a\u6a21\u5757\u7ba1\u7406\u5de5\u5177\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u4f7f\u7528 **FastAPIBehaviour**\n\u4ee5\u5728 Saya \u6a21\u5757\u4e2d\u66f4\u65b9\u4fbf\u5730\u4f7f\u7528 FastAPI\u3002\n\nFastAPI \u672c\u8eab\u5e76 **\u4e0d\u81ea\u5e26** ASGI \u670d\u52a1\u5668\uff0c\u56e0\u6b64\u4f60\u9700\u8981\u989d\u5916\u6dfb\u52a0\u4e00\u4e2a **UvicornService**\u3002\n\n```python\nfrom creart import create\nfrom graia.ariadne.app import Ariadne\nfrom graia.amnesia.builtins.uvicorn import UvicornService\nfrom graiax.fastapi import FastAPIBehaviour, FastAPIService\nfrom graia.saya import Saya\n\napp = Ariadne(...)\nsaya = create(Saya)\nfastapi = FastAPI()\n\nsaya.install_behaviours(FastAPIBehaviour(fastapi))\n\n# \u53ef\u4ee5\u4e0d\u521b\u5efa FastAPI \u5b9e\u4f8b, \u4ea4\u7ed9 FastAPIService \u81ea\u5df1\u521b\u5efa\n# app.launch_manager.add_service(FastAPIService())\n# \u8fd9\u6837\u7684\u8bdd\u5c31\u4e0d\u80fd\u7ed9 FastAPI \u4f20\u53c2\u5e76\u81ea\u5b9a\u4e49 FastAPI\napp.launch_manager.add_service(FastAPIService(fastapi))\napp.launch_manager.add_service(UvicornService())\n\nAriadne.launch_blocking()\n```\n\n#### Saya \u6a21\u5757\u4e2d\n\n```python\nfrom graia.saya import Channel\nfrom pydantic import BaseModel\n\nfrom graiax.fastapi import RouteSchema, route\n\nchannel = Channel.current()\n\n\nclass ResponseModel(BaseModel):\n    code: int\n    message: str\n\n\n# \u65b9\u5f0f\u4e00\uff1a\u50cf FastAPI \u90a3\u6837\u76f4\u63a5\u4f7f\u7528\u88c5\u9970\u5668\n@route.get(\"/\", response_model=ResponseModel)\nasync def root():\n    return {\"code\": 200, \"message\": \"Hello World!\"}\n\n\n# \u65b9\u5f0f\u4e8c\uff1a\u5f53\u4f60\u5148\u9700\u8981\u540c\u4e00\u4e2a\u8def\u5f84\u6709\u591a\u79cd\u8bf7\u6c42\u65b9\u5f0f\u65f6\u4f60\u53ef\u4ee5\u8fd9\u6837\u505a\n@route.route([\"GET\"], \"/xxxxx\")\nasync def xxxxx():\n    return \"xxxx\"\n\n\n# \u65b9\u5f0f\u4e09\uff1a\u4e0a\u9762\u90a3\u79cd\u65b9\u5f0f\u5b9e\u9645\u4e0a\u4e5f\u53ef\u4ee5\u8fd9\u4e48\u5199\n@channel.use(RouteSchema(\"/xxx\", methods=[\"GET\", \"POST\"]))\nasync def xxx():\n    return \"xxx\"\n\n\n# Websocket\nfrom fastapi import WebSocket\nfrom starlette.websockets import WebSocketDisconnect\nfrom websockets.exceptions import ConnectionClosedOK\n\n\n@route.ws(\"/ws\")\n# \u7b49\u4ef7\u4e8e @channel.use(WebsocketRouteSchema(\"/ws\"))\nasync def ws(websocket: WebSocket):\n    await websocket.accept()\n    while True:\n        try:\n            print(await websocket.receive_text())\n        except (WebSocketDisconnect, ConnectionClosedOK, RuntimeError):\n            break\n```\n\n#### \u5176\u4ed6\u65b9\u5f0f\n\n\u5047\u5982\u4f60\u4e0d\u60f3\u5728 Saya \u6a21\u5757\u4e2d\u4e3a FastAPI \u6dfb\u52a0\u8def\u7531\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u9009\u62e9\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a\n\n<details>\n\n##### \u5728\u673a\u5668\u4eba\u5165\u53e3\u6587\u4ef6\u4e2d\u76f4\u63a5\u6dfb\u52a0\n\n```python\n...\nfastapi = FastAPI()\n\n\n@fastapi.get(\"/main\")\nasync def main():\n    return \"main\"\n\n\napp.launch_manager.add_service(FastAPIService(fastapi))\n...\n```\n\n##### \u5728 Ariadne \u542f\u52a8\u6210\u529f\u540e\u6dfb\u52a0\n\n```python\nfrom graia.amnesia.builtins.uvicorn import ASGIHandlerProvider\n\n\nasync def root():\n    ...\n\n\n@listen(ApplicationLaunched)\nasync def function(app: Ariadne):\n    mgr = app.launch_manager\n    fastapi: FastAPI = mgr.get_interface(ASGIHandlerProvider).get_asgi_handler()  # type: ignore\n    fastapi.add_middleware(\n        CORSMiddleware,\n        allow_origins=['*'],\n        allow_credentials=True,\n        allow_methods=['*'],\n        allow_headers=['*'],\n    )\n    fastapi.add_api_route('/', endpoint=root, methods=['GET'])\n    fastapi.get('/main')(root)\n    fastapi.add_api_websocket_route('/ws', endpoint=websocket)\n```\n\n</details>\n\n",
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "MIT",
            "maintainer": "",
            "maintainer_email": "",
            "name": "graiax-fastapi",
            "package_url": "https://pypi.org/project/graiax-fastapi/",
            "platform": null,
            "project_url": "https://pypi.org/project/graiax-fastapi/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/graiax-fastapi/0.2.0/",
            "requires_dist": [
                "fastapi>=0.70.0",
                "graia-amnesia>=0.6.0",
                "graia-saya>=0.0.16",
                "typing-extensions>=4.0.0"
            ],
            "requires_python": ">=3.8",
            "summary": "FastAPI for GraiaCommunity.",
            "version": "0.2.0",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15436168,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "1da07698294f99a5353e92fda774dfd0",
                    "sha256": "474b43dd514667e1883391469195232464ebef3cd89280ad60d914579607e657"
                },
                "downloads": -1,
                "filename": "graiax_fastapi-0.2.0-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "1da07698294f99a5353e92fda774dfd0",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.8",
                "size": 7694,
                "upload_time": "2022-10-17T12:58:36",
                "upload_time_iso_8601": "2022-10-17T12:58:36.015456Z",
                "url": "https://files.pythonhosted.org/packages/5e/53/4f668b7a343e47c3d6699feec34fbb6145965c5210dd0f4cf09d9a258344/graiax_fastapi-0.2.0-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "991393fca227a367a0d93a59cce9877a",
                    "sha256": "234521f33cb4f3b8e16aaf61236e9f16505ec04c8457db250d29a2b44387adba"
                },
                "downloads": -1,
                "filename": "graiax-fastapi-0.2.0.tar.gz",
                "has_sig": false,
                "md5_digest": "991393fca227a367a0d93a59cce9877a",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.8",
                "size": 8180,
                "upload_time": "2022-10-17T12:58:37",
                "upload_time_iso_8601": "2022-10-17T12:58:37.526501Z",
                "url": "https://files.pythonhosted.org/packages/7e/b1/0ab3e94658306473c0765a3dc9a731ae414de55d30e260053dc741e51f17/graiax-fastapi-0.2.0.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}